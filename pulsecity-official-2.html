<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PulseCity - Advanced City Intelligence Dashboard</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;600;700;900&family=Open+Sans:wght@400;600;700&display=swap" rel="stylesheet">
    <!-- Enhanced Libraries -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="https://cesium.com/downloads/cesiumjs/releases/1.111/Build/Cesium/Cesium.js"></script>
    <link href="https://cesium.com/downloads/cesiumjs/releases/1.111/Build/Cesium/Widgets/widgets.css" rel="stylesheet">
    <style>
        :root {
            --bg-primary: #FFFFFF;
            --bg-secondary: #F5F5F5;
            --bg-tertiary: #EEEEEE;
            --card-bg: #FFFFFF;
            --border: #E0E0E0;
            --blue: #1976D2;
            --primary: #1A237E;
            --secondary: #283593;
            --green: #388E3C;
            --orange: #F57C00;
            --red: #D32F2F;
            --purple: #7B1FA2;
            --cyan: #0097A7;
            --text: #212121;
            --text-dim: #757575;
            --accent-gradient: linear-gradient(135deg, #1A237E 0%, #283593 100%);
            --glow: rgba(26, 35, 126, 0.1);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: 'Roboto', 'Open Sans', Arial, Helvetica, sans-serif; 
            background: var(--bg-primary);
            color: var(--text);
            font-size: 16px;
            line-height: 1.6;
        }
        
        .dashboard { display: grid; grid-template-columns: 260px 1fr; grid-template-rows: 70px 1fr; min-height: 100vh; background: var(--bg-secondary); }
        
        .topbar { 
            grid-column: 1 / -1; 
            background: var(--primary);
            border-bottom: 3px solid var(--secondary); 
            display: flex; 
            align-items: center; 
            justify-content: space-between; 
            padding: 0 2rem; 
            position: sticky; 
            top: 0; 
            z-index: 100;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            height: 70px;
        }
        .logo { 
            font-size: 28px; 
            font-weight: 700; 
            color: #FFFFFF;
            letter-spacing: 0.5px;
            font-family: 'Roboto', sans-serif;
        }
        .search input { 
            padding: 0.65rem 1rem; 
            background: #FFFFFF;
            border: 1px solid rgba(255, 255, 255, 0.3); 
            border-radius: 4px; 
            color: var(--text); 
            width: 300px;
            transition: all 0.2s ease;
            font-family: 'Roboto', sans-serif;
        }
        .search input:focus { 
            outline: none; 
            border-color: #FFFFFF;
            box-shadow: 0 0 0 2px rgba(255, 255, 255, 0.2);
        }
        .search input::placeholder {
            color: #9E9E9E;
        }
        
        .sidebar { 
            background: #FFFFFF;
            border-right: 1px solid var(--border); 
            padding: 1.5rem 0; 
            overflow-y: auto; 
            position: sticky; 
            top: 70px; 
            height: calc(100vh - 70px);
            box-shadow: 2px 0 4px rgba(0, 0, 0, 0.05);
        }
        .nav-section { margin-bottom: 2rem; }
        .nav-title { padding: 0 1.5rem; font-size: 12px; font-weight: 700; text-transform: uppercase; color: var(--text-dim); letter-spacing: 0.1em; margin-bottom: 0.75rem; font-family: 'Roboto', sans-serif; }
        .nav-item { 
            display: flex; 
            align-items: center; 
            gap: 0.75rem; 
            padding: 0.75rem 1.5rem; 
            color: var(--text); 
            cursor: pointer; 
            transition: all 0.2s ease; 
            position: relative;
            border-left: 3px solid transparent;
            font-size: 15px;
            font-weight: 500;
        }
        .nav-item:hover { 
            background: rgba(26, 35, 126, 0.05); 
            color: var(--primary);
            border-left-color: var(--blue);
        }
        .nav-item.active { 
            background: rgba(26, 35, 126, 0.08); 
            color: var(--primary); 
            font-weight: 600;
            border-left-color: var(--primary);
        }
        .nav-item.active::before { 
            display: none;
        }
        .badge { 
            margin-left: auto; 
            padding: 0.2rem 0.5rem; 
            background: var(--red); 
            color: white; 
            font-size: 11px; 
            border-radius: 3px; 
            font-weight: 700;
        }
        
        .main { padding: 30px 40px; overflow-y: auto; max-height: calc(100vh - 70px); background: var(--bg-secondary); }
        .section { display: none; animation: fadeIn 0.3s; }
        .section.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        
        .header { margin-bottom: 30px; padding-bottom: 20px; border-bottom: 2px solid var(--border); }
        .title { 
            font-size: 34px; 
            font-weight: 700; 
            margin-bottom: 0.5rem;
            color: var(--primary);
            font-family: 'Roboto', sans-serif;
            letter-spacing: 0;
        }
        .subtitle { color: var(--text-dim); font-size: 16px; line-height: 1.5; }
        
        .stats { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 30px; }
        .stat-card { 
            background: #FFFFFF;
            border: 1px solid var(--border); 
            border-radius: 4px; 
            padding: 24px; 
            transition: all 0.2s ease; 
            position: relative; 
            overflow: hidden;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }
        .stat-card::before { 
            content: ''; 
            position: absolute; 
            top: 0; 
            left: 0; 
            right: 0; 
            height: 4px; 
            background: var(--primary);
        }
        .stat-card:hover { 
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
        }
        .stat-label { font-size: 14px; color: var(--text-dim); font-weight: 500; margin-bottom: 0.5rem; text-transform: uppercase; letter-spacing: 0.5px; }
        .stat-value { 
            font-size: 36px; 
            font-weight: 700; 
            margin: 0.5rem 0;
            color: var(--primary);
            font-family: 'Roboto', sans-serif;
        }
        .stat-change { display: inline-flex; align-items: center; gap: 0.25rem; padding: 0.25rem 0.5rem; border-radius: 6px; font-size: 0.75rem; font-weight: 600; }
        .stat-change.positive { background: rgba(16, 185, 129, 0.1); color: var(--green); }
        .stat-change.negative { background: rgba(239, 68, 68, 0.1); color: var(--red); }
        .progress { 
            width: 100%; 
            height: 8px; 
            background: #E0E0E0; 
            border-radius: 4px; 
            overflow: hidden; 
            margin: 0.5rem 0;
        }
        .progress-bar { 
            height: 100%; 
            background: var(--blue); 
            border-radius: 4px; 
            transition: width 0.6s ease;
        }
        
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); gap: 20px; margin-bottom: 30px; }
        .card { 
            background: #FFFFFF;
            border: 1px solid var(--border); 
            border-radius: 4px; 
            padding: 24px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            transition: all 0.2s ease;
        }
        .card:hover {
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
        }
        .card-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; padding-bottom: 15px; border-bottom: 2px solid var(--bg-secondary); }
        .card-title { 
            font-size: 24px; 
            font-weight: 600; 
            display: flex; 
            align-items: center; 
            gap: 0.6rem;
            color: var(--primary);
            font-family: 'Roboto', sans-serif;
        }
        
        .list { list-style: none; }
        .list-item { 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            padding: 15px; 
            background: var(--bg-secondary);
            border-radius: 4px; 
            margin-bottom: 10px; 
            transition: all 0.2s ease;
            border-left: 3px solid transparent;
        }
        .list-item:hover { 
            background: #EEEEEE;
            border-left-color: var(--blue);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        .list-info { display: flex; align-items: center; gap: 1rem; flex: 1; }
        .list-icon { 
            width: 40px; 
            height: 40px; 
            border-radius: 4px; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            font-size: 1.25rem; 
            background: var(--primary);
            color: #FFFFFF;
        }
        .list-title { font-weight: 600; margin-bottom: 0.25rem; color: var(--text); }
        .list-meta { font-size: 0.85rem; color: var(--text-dim); }
        
        .status { display: inline-flex; align-items: center; gap: 0.5rem; padding: 0.35rem 0.75rem; border-radius: 6px; font-size: 0.85rem; font-weight: 600; }
        .status-dot { width: 8px; height: 8px; border-radius: 50%; animation: blink 2s infinite; }
        @keyframes blink { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
        .status-good { background: rgba(16, 185, 129, 0.1); color: var(--green); }
        .status-good .status-dot { background: var(--green); }
        .status-warning { background: rgba(245, 158, 11, 0.1); color: var(--orange); }
        .status-warning .status-dot { background: var(--orange); }
        .status-danger { background: rgba(239, 68, 68, 0.1); color: var(--red); }
        .status-danger .status-dot { background: var(--red); }
        
        .alert { padding: 15px 18px; border-radius: 4px; margin-bottom: 15px; display: flex; align-items: flex-start; gap: 12px; border-left: 4px solid; }
        .alert-warning { background: rgba(245, 158, 11, 0.1); border: 1px solid var(--orange); color: var(--orange); }
        .alert-danger { background: rgba(239, 68, 68, 0.1); border: 1px solid var(--red); color: var(--red); }
        .alert-success { background: rgba(16, 185, 129, 0.1); border: 1px solid var(--green); color: var(--green); }
        .alert-info { background: rgba(59, 130, 246, 0.1); border: 1px solid var(--blue); color: var(--blue); }
        .alert-icon { font-size: 1.25rem; }
        .alert-title { font-weight: 700; margin-bottom: 0.25rem; }
        
        .form-group { margin-bottom: 1.25rem; }
        .form-label { display: block; font-size: 14px; font-weight: 500; color: var(--text); margin-bottom: 6px; }
        .form-input, .form-select, .form-textarea { 
            width: 100%; 
            padding: 10px 12px; 
            background: #FFFFFF;
            border: 1px solid var(--border); 
            border-radius: 4px; 
            color: var(--text); 
            font-size: 16px; 
            transition: all 0.2s ease; 
            font-family: 'Roboto', 'Open Sans', sans-serif;
        }
        .form-input:focus, .form-select:focus, .form-textarea:focus { 
            outline: none; 
            border-color: var(--blue); 
            box-shadow: 0 0 0 2px rgba(25, 118, 210, 0.1);
        }
        .form-textarea { min-height: 100px; resize: vertical; }
        
        .btn { 
            padding: 10px 24px; 
            border: none; 
            border-radius: 4px; 
            font-weight: 500; 
            cursor: pointer; 
            transition: all 0.2s ease; 
            font-size: 16px; 
            display: inline-flex; 
            align-items: center; 
            gap: 0.5rem;
            font-family: 'Roboto', sans-serif;
        }
        .btn-primary { 
            background: var(--primary); 
            color: white;
        }
        .btn-primary:hover { 
            background: var(--secondary);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }
        .btn-success { 
            background: var(--green); 
            color: white;
        }
        .btn-success:hover { 
            background: #2E7D32;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }
        .btn-danger { 
            background: var(--red); 
            color: white;
        }
        .btn-danger:hover { 
            background: #C62828;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }
        
        .toast { 
            position: fixed; 
            bottom: 2rem; 
            right: 2rem; 
            background: #FFFFFF;
            border: 1px solid var(--border); 
            border-radius: 4px; 
            padding: 16px 20px; 
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15); 
            transform: translateY(100px); 
            opacity: 0; 
            transition: all 0.3s ease; 
            z-index: 1001; 
            min-width: 320px;
        }
        .toast.show { transform: translateY(0); opacity: 1; }
        .toast-content { display: flex; align-items: center; gap: 0.75rem; }
        .toast-icon { font-size: 1.5rem; }
        .toast-title { font-weight: 700; margin-bottom: 0.25rem; }
        .toast-text { font-size: 0.875rem; color: var(--text-dim); }
        
        table { width: 100%; border-collapse: collapse; background: #FFFFFF; }
        thead { background: var(--bg-secondary); }
        th { padding: 12px 15px; text-align: left; font-weight: 600; font-size: 14px; color: var(--text); text-transform: uppercase; letter-spacing: 0.5px; }
        td { padding: 12px 15px; border-top: 1px solid var(--border); color: var(--text); }
        tbody tr { transition: background 0.2s; }
        tbody tr:hover { background: #FAFAFA; }
        
        .poll { margin-bottom: 1.5rem; padding: 1rem; background: rgba(168, 85, 247, 0.1); border-radius: 8px; }
        .poll-question { font-weight: 700; color: var(--purple); margin-bottom: 0.75rem; }
        .poll-option { display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem; cursor: pointer; padding: 0.5rem; border-radius: 6px; transition: background 0.2s; }
        .poll-option:hover { background: rgba(255,255,255,0.05); }
        .poll-option input[type="radio"] { cursor: pointer; }
        .poll-meta { font-size: 0.85rem; color: var(--text-dim); margin-top: 0.75rem; }
        
        /* Authentication Styles */
        .login-screen { display: none; align-items: center; justify-content: center; min-height: 100vh; background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%); position: fixed; top: 0; left: 0; right: 0; bottom: 0; z-index: 9999; }
        .login-screen.active { display: flex; }
        .login-box { background: var(--card-bg); border: 1px solid var(--border); border-radius: 16px; padding: 3rem; width: 100%; max-width: 450px; box-shadow: 0 20px 60px rgba(0,0,0,0.5); }
        .login-logo { font-size: 2.5rem; font-weight: 800; background: linear-gradient(135deg, var(--blue), var(--cyan)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; text-align: center; margin-bottom: 2rem; }
        .role-selector { display: flex; gap: 1rem; margin-bottom: 2rem; }
        .role-btn { flex: 1; padding: 1rem; background: var(--bg-tertiary); border: 2px solid var(--border); border-radius: 8px; cursor: pointer; transition: all 0.3s; text-align: center; font-weight: 600; }
        .role-btn.active { background: rgba(59, 130, 246, 0.2); border-color: var(--blue); color: var(--blue); }
        
        /* Video Streaming Styles */
        .video-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 1.5rem; }
        .video-container { position: relative; background: #000; border-radius: 12px; overflow: hidden; aspect-ratio: 16/9; }
        .video-stream { width: 100%; height: 100%; object-fit: cover; }
        .video-overlay { position: absolute; bottom: 0; left: 0; right: 0; background: linear-gradient(to top, rgba(0,0,0,0.9), transparent); padding: 1rem; color: white; }
        .video-status { display: flex; align-items: center; gap: 0.5rem; font-size: 0.85rem; opacity: 0.9; }
        .stream-indicator { width: 8px; height: 8px; background: var(--green); border-radius: 50%; animation: blink 2s infinite; }
        
        /* 3D Cesium Viewer */
        #cesiumContainer { width: 100%; height: 600px; border-radius: 12px; overflow: hidden; background: #000; }
        
        /* AI Chat Interface */
        .ai-chat { display: flex; flex-direction: column; height: 600px; background: var(--card-bg); border: 1px solid var(--border); border-radius: 12px; overflow: hidden; }
        .chat-messages { flex: 1; overflow-y: auto; padding: 1.5rem; display: flex; flex-direction: column; gap: 1rem; }
        .chat-message { display: flex; gap: 1rem; animation: slideIn 0.3s; }
        @keyframes slideIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .chat-avatar { width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.25rem; flex-shrink: 0; }
        .chat-avatar.user { background: linear-gradient(135deg, var(--blue), var(--purple)); }
        .chat-avatar.ai { background: linear-gradient(135deg, var(--green), var(--cyan)); }
        .chat-bubble { background: var(--bg-tertiary); padding: 1rem 1.5rem; border-radius: 12px; max-width: 75%; }
        .chat-bubble.user { background: rgba(59, 130, 246, 0.2); margin-left: auto; }
        .chat-input-area { border-top: 1px solid var(--border); padding: 1.5rem; display: flex; gap: 1rem; }
        .chat-input { flex: 1; padding: 0.75rem 1rem; background: var(--bg-tertiary); border: 1px solid var(--border); border-radius: 8px; color: var(--text); resize: none; font-family: 'Inter', sans-serif; min-height: 60px; }
        
        /* Mobile App Preview */
        .mobile-preview { max-width: 375px; margin: 0 auto; background: var(--bg-secondary); border-radius: 32px; padding: 1.5rem; border: 8px solid var(--bg-tertiary); box-shadow: 0 20px 60px rgba(0,0,0,0.5); }
        .mobile-screen { background: var(--card-bg); border-radius: 20px; overflow: hidden; }
        .mobile-header { background: var(--bg-tertiary); padding: 1.25rem; text-align: center; font-weight: 700; font-size: 1.1rem; }
        .mobile-content { padding: 1.5rem; }
        .gps-indicator { display: flex; align-items: center; gap: 0.75rem; padding: 1rem; background: rgba(16, 185, 129, 0.15); border-radius: 8px; color: var(--green); margin-bottom: 1.5rem; border: 1px solid rgba(16, 185, 129, 0.3); }
        .gps-pulse { width: 12px; height: 12px; background: var(--green); border-radius: 50%; animation: pulse 2s infinite; }
        @keyframes pulse { 0%, 100% { transform: scale(1); opacity: 1; } 50% { transform: scale(1.2); opacity: 0.6; } }
        
        /* Analytics Charts */
        .analytics-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); gap: 1.5rem; }
        .chart-container { background: var(--card-bg); border: 1px solid var(--border); border-radius: 12px; padding: 1.5rem; }
        .chart-canvas { width: 100% !important; height: 300px !important; }
        
        /* Emergency Panel Enhancements */
        .emergency-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 1.5rem; }
        .emergency-card { background: var(--card-bg); border: 2px solid var(--border); border-radius: 12px; padding: 1.5rem; transition: all 0.3s; position: relative; }
        .emergency-card.critical { border-color: var(--red); animation: emergencyPulse 2s infinite; }
        @keyframes emergencyPulse { 0%, 100% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.4); } 50% { box-shadow: 0 0 0 15px rgba(239, 68, 68, 0); } }
        .priority-badge { position: absolute; top: 1rem; right: 1rem; padding: 0.35rem 0.75rem; border-radius: 6px; font-size: 0.75rem; font-weight: 700; text-transform: uppercase; }
        .priority-critical { background: var(--red); color: white; }
        .priority-high { background: var(--orange); color: white; }
        
        /* ML Prediction Indicators */
        .ml-badge { display: inline-flex; align-items: center; gap: 0.5rem; padding: 0.5rem 0.75rem; background: rgba(139, 92, 246, 0.15); border: 1px solid rgba(139, 92, 246, 0.3); border-radius: 6px; color: var(--purple); font-size: 0.85rem; font-weight: 600; }
        .ml-badge::before { content: 'ü§ñ'; }
        
        /* Notification Bell Enhancement */
        .notification-btn { position: relative; padding: 0.5rem 0.75rem; background: var(--bg-tertiary); border: none; border-radius: 8px; cursor: pointer; color: var(--text); font-size: 1.25rem; transition: all 0.2s; }
        .notification-badge { position: absolute; top: -6px; right: -6px; background: var(--red); color: white; font-size: 0.7rem; padding: 0.2rem 0.5rem; border-radius: 10px; font-weight: 700; animation: bounce 2s infinite; }
        @keyframes bounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-4px); } }
        
        @media (max-width: 1024px) {
            .dashboard { grid-template-columns: 1fr; }
            .sidebar { display: none; }
            .grid, .analytics-grid, .emergency-grid, .video-grid { grid-template-columns: 1fr; }
        }

        /* === STYLES FROM FILE 2 === */
        .login-container { position: fixed; inset: 0; background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%); display: flex; align-items: center; justify-content: center; z-index: 1000; }
        .login-container.hidden { display: none; }
        .login-box { background: var(--card-bg); border: 1px solid var(--border); border-radius: 16px; padding: 3rem; width: 100%; max-width: 450px; box-shadow: 0 20px 60px rgba(0,0,0,0.5); }
        .login-logo { font-size: 2.5rem; font-weight: 800; text-align: center; margin-bottom: 0.5rem; background: linear-gradient(135deg, var(--blue), var(--cyan)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .login-subtitle { text-align: center; color: var(--text-dim); margin-bottom: 2rem; }
        .login-alert { padding: 0.75rem; background: rgba(239, 68, 68, 0.1); border: 1px solid var(--red); color: var(--red); border-radius: 8px; margin-bottom: 1rem; font-size: 0.875rem; text-align: center; opacity: 0; transition: opacity 0.3s; }
        .login-alert.show { opacity: 1; }
        .login-info { background: rgba(59, 130, 246, 0.1); border: 1px solid var(--blue); color: var(--blue); padding: 1rem; border-radius: 8px; margin-top: 1.5rem; font-size: 0.85rem; }
        .login-info-title { font-weight: 700; margin-bottom: 0.5rem; }

        .dashboard-wrapper { opacity: 0; pointer-events: none; transition: opacity 0.3s; }
        .dashboard-wrapper.show { opacity: 1; pointer-events: all; }

        .user-profile { display: flex; align-items: center; gap: 0.75rem; cursor: pointer; position: relative; }
        .user-avatar { width: 40px; height: 40px; border-radius: 50%; background: linear-gradient(135deg, var(--blue), var(--purple)); display: flex; align-items: center; justify-content: center; font-weight: 700; font-size: 0.9rem; }
        .logout-dropdown { position: absolute; top: 100%; right: 0; margin-top: 0.5rem; background: var(--card-bg); border: 1px solid var(--border); border-radius: 8px; padding: 0.5rem; min-width: 150px; box-shadow: 0 10px 30px rgba(0,0,0,0.3); opacity: 0; pointer-events: none; transform: translateY(-10px); transition: all 0.2s; }
        .logout-dropdown.show { opacity: 1; pointer-events: all; transform: translateY(0); }
        .logout-dropdown button { width: 100%; padding: 0.5rem 1rem; background: transparent; border: none; color: var(--text); text-align: left; cursor: pointer; border-radius: 4px; transition: background 0.2s; font-size: 0.9rem; }
        .logout-dropdown button:hover { background: var(--bg-tertiary); }

        /* Mobile App Reports Styles */
        .report-form { background: var(--bg-tertiary); padding: 1.5rem; border-radius: 8px; margin-bottom: 2rem; }
        .location-display { display: flex; align-items: center; gap: 0.5rem; padding: 0.75rem; background: rgba(16, 185, 129, 0.1); border: 1px solid var(--green); border-radius: 8px; margin-top: 0.5rem; color: var(--green); font-size: 0.85rem; }
        .location-icon { font-size: 1rem; }
        .map-container { height: 400px; border-radius: 8px; overflow: hidden; margin-bottom: 1.5rem; }
        .incident-marker { background: var(--red); color: white; border-radius: 50%; width: 30px; height: 30px; display: flex; align-items: center; justify-content: center; font-weight: bold; }
        .report-item { background: var(--bg-tertiary); border-left: 4px solid var(--blue); padding: 1rem; border-radius: 8px; margin-bottom: 1rem; }
        .report-header { display: flex; justify-content: space-between; align-items: start; margin-bottom: 0.75rem; }
        .report-type { display: inline-block; padding: 0.25rem 0.75rem; background: var(--blue); color: white; border-radius: 6px; font-size: 0.8rem; font-weight: 600; }
        .report-time { color: var(--text-dim); font-size: 0.85rem; }
        .report-location { display: flex; align-items: center; gap: 0.5rem; color: var(--text-dim); font-size: 0.85rem; margin-top: 0.5rem; }
    </style>
</head>
<body>
    <!-- Login Screen (from File 2) -->
    <div id="loginContainer" class="login-container">
        <div class="login-box">
            <div class="login-logo">üèôÔ∏è URBAN ALLY</div>
            <div class="login-subtitle">Advanced City Intelligence Dashboard</div>
            
            <div id="loginError" class="login-alert">
                Invalid username or password
            </div>
            
            <form id="loginForm">
                <div class="form-group">
                    <label class="form-label">Username</label>
                    <input type="text" id="loginUsername" class="form-input" required placeholder="Enter username">
                </div>
                <div class="form-group">
                    <label class="form-label">Password</label>
                    <input type="password" id="loginPassword" class="form-input" required placeholder="Enter password">
                </div>
                <button type="submit" class="btn btn-primary" style="width: 100%;">
                    üîê Sign In
                </button>
            </form>
            
            <div class="login-info">
                <div class="login-info-title">Demo Credentials</div>
                <div>Admin: <strong>admin</strong> / <strong>admin123</strong></div>
                <div>User: <strong>user</strong> / <strong>user123</strong></div>
            </div>
        </div>
    </div>

    <!-- Dashboard (wrapped in dashboard-wrapper for login gating) -->
    <div id="dashboardWrapper" class="dashboard-wrapper">
    <div class="dashboard">
        <div class="topbar">
            <div class="logo">üåê PulseCity</div>
            <div class="search">
                <input type="text" placeholder="Search city data..." id="globalSearch">
            </div>
            <div id="userProfile" class="user-profile">
                <div id="userAvatar" class="user-avatar">AD</div>
                <span id="userName">Admin User</span>
                <div id="logoutDropdown" class="logout-dropdown">
                    <button id="logoutBtn">üö™ Logout</button>
                </div>
            </div>
        </div>

        <nav class="sidebar">
            <div class="nav-section">
                <div class="nav-title">Overview</div>
                <div class="nav-item active" data-section="dashboard">üìä Dashboard</div>
                <div class="nav-item" data-section="health">‚ù§Ô∏è City Health</div>
            </div>
            <div class="nav-section">
                <div class="nav-title">Infrastructure</div>
                <div class="nav-item" data-section="traffic">üö¶ Traffic & Transit</div>
                <div class="nav-item" data-section="utilities">üîå Utilities</div>
                <div class="nav-item" data-section="parking">üÖøÔ∏è Parking</div>
            </div>
            <div class="nav-section">
                <div class="nav-title">Environment</div>
                <div class="nav-item" data-section="air">üè≠ Air Quality</div>
                <div class="nav-item" data-section="weather">üå§Ô∏è Weather</div>
                <div class="nav-item" data-section="noise">üîä Noise Levels</div>
                <div class="nav-item" data-section="waste">üóëÔ∏è Waste</div>
            </div>
            <div class="nav-section">
                <div class="nav-title">Safety & Community</div>
                <div class="nav-item" data-section="emergency">üö® Emergencies<span class="badge" id="emergencyBadge">3</span></div>
                <div class="nav-item" data-section="crime">üõ°Ô∏è Crime & Safety</div>
                <div class="nav-item" data-section="citizen">üó£Ô∏è Citizen Reports</div>
            </div>
            <div class="nav-section">
                <div class="nav-title">City Services</div>
                <div class="nav-item" data-section="events">üìÖ Events</div>
                <div class="nav-item" data-section="sensors">üì° IoT Sensors</div>
                <div class="nav-item" data-section="polls">üó≥Ô∏è Polls</div>
                <div class="nav-item" data-section="budget">üí∞ Budget</div>
            </div>
            <div class="nav-section">
                <div class="nav-title">Monitoring</div>
                <div class="nav-item" data-section="monitoring">üéØ Real-time Monitoring</div>
            </div>
            <div class="nav-section">
                <div class="nav-title">Mobile</div>
                <div class="nav-item" data-section="gps-reporting">üìç GPS Reporting</div>
                <div class="nav-item" data-section="mobile-reports">üì± Mobile Reports<span class="badge">New</span></div>
            </div>
            <div class="nav-section">
                <div class="nav-title">System</div>
                <div class="nav-item" data-section="analytics">üìä Analytics & Reporting</div>
            </div>
        </nav>

        <main class="main">
            <!-- DASHBOARD -->
            <section id="dashboard" class="section active">
                <div class="header">
                    <h1 class="title">City Dashboard</h1>
                    <p class="subtitle">Real-time overview of city operations</p>
                </div>

                <div class="stats">
                    <div class="stat-card" style="--accent: var(--green)">
                        <div class="stat-label">City Health Score</div>
                        <div class="stat-value" id="healthScore">85</div>
                        <span class="stat-change positive">‚Üë 3.2%</span>
                        <div class="progress"><div class="progress-bar" style="width: 85%"></div></div>
                    </div>
                    <div class="stat-card" style="--accent: var(--red)">
                        <div class="stat-label">Active Emergencies</div>
                        <div class="stat-value" id="totalEmergencies">3</div>
                        <span class="stat-change negative">‚Üë 2</span>
                    </div>
                    <div class="stat-card" style="--accent: var(--blue)">
                        <div class="stat-label">Traffic Flow</div>
                        <div class="stat-value">72%</div>
                        <span class="stat-change positive">‚Üë 5.1%</span>
                        <div class="progress"><div class="progress-bar" style="width: 72%"></div></div>
                    </div>
                    <div class="stat-card" style="--accent: var(--green)">
                        <div class="stat-label">Air Quality Index</div>
                        <div class="stat-value">68</div>
                        <span class="stat-change positive">‚Üì 12</span>
                    </div>
                </div>

                <div class="grid">
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">üö® Recent Emergencies</h3>
                        </div>
                        <ul class="list" id="dashEmergencies"></ul>
                    </div>
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">üó£Ô∏è Top Citizen Issues</h3>
                        </div>
                        <ul class="list" id="dashIssues"></ul>
                    </div>
                </div>

                <div class="alert alert-warning">
                    <span class="alert-icon">‚ö†Ô∏è</span>
                    <div>
                        <div class="alert-title">Weather Alert</div>
                        <div>Thunderstorm warning from 6 PM to 10 PM tonight</div>
                    </div>
                </div>
            </section>

            <!-- CITY HEALTH -->
            <section id="health" class="section">
                <div class="header">
                    <h1 class="title">City Health Score</h1>
                    <p class="subtitle">Comprehensive health metrics</p>
                </div>

                <div class="stats">
                    <div class="stat-card" style="--accent: var(--green)">
                        <div class="stat-label">Overall Score</div>
                        <div class="stat-value">85</div>
                        <div class="progress"><div class="progress-bar" style="width: 85%"></div></div>
                    </div>
                    <div class="stat-card" style="--accent: var(--blue)">
                        <div class="stat-label">Infrastructure</div>
                        <div class="stat-value">78</div>
                        <div class="progress"><div class="progress-bar" style="width: 78%"></div></div>
                    </div>
                    <div class="stat-card" style="--accent: var(--green)">
                        <div class="stat-label">Environment</div>
                        <div class="stat-value">82</div>
                        <div class="progress"><div class="progress-bar" style="width: 82%"></div></div>
                    </div>
                    <div class="stat-card" style="--accent: var(--purple)">
                        <div class="stat-label">Community</div>
                        <div class="stat-value">91</div>
                        <div class="progress"><div class="progress-bar" style="width: 91%"></div></div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Health Metrics Breakdown</h3>
                    </div>
                    <table>
                        <thead>
                            <tr><th>Metric</th><th>Score</th><th>Status</th><th>Trend</th></tr>
                        </thead>
                        <tbody id="healthTable"></tbody>
                    </table>
                </div>
            </section>

            <!-- TRAFFIC & TRANSIT -->
            <section id="traffic" class="section">
                <div class="header">
                    <h1 class="title">Traffic & Public Transit</h1>
                    <p class="subtitle">Real-time traffic and transit tracking</p>
                </div>

                <div class="stats">
                    <div class="stat-card" style="--accent: var(--blue)">
                        <div class="stat-label">Traffic Flow</div>
                        <div class="stat-value">72%</div>
                        <div class="progress"><div class="progress-bar" style="width: 72%"></div></div>
                    </div>
                    <div class="stat-card" style="--accent: var(--green)">
                        <div class="stat-label">Transit On-Time</div>
                        <div class="stat-value">94%</div>
                    </div>
                    <div class="stat-card" style="--accent: var(--orange)">
                        <div class="stat-label">Avg. Commute</div>
                        <div class="stat-value">28 min</div>
                    </div>
                </div>

                <div class="grid">
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">üö¶ Traffic Conditions</h3>
                        </div>
                        <ul class="list" id="trafficList"></ul>
                        <form id="trafficForm">
                            <div class="form-group">
                                <label class="form-label">Check Route Traffic</label>
                                <input type="text" class="form-input" placeholder="Enter destination...">
                            </div>
                            <button type="submit" class="btn btn-primary">Get Prediction</button>
                        </form>
                    </div>
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">üöá Transit Status</h3>
                        </div>
                        <ul class="list" id="transitList"></ul>
                        <form id="transitForm">
                            <div class="form-group">
                                <label class="form-label">Track Route</label>
                                <input type="text" class="form-input" placeholder="Enter route number...">
                            </div>
                            <button type="submit" class="btn btn-primary">Track</button>
                        </form>
                    </div>
                </div>
            </section>

            <!-- AIR QUALITY -->
            <section id="air" class="section">
                <div class="header">
                    <h1 class="title">Air Quality Monitoring</h1>
                    <p class="subtitle">Real-time AQI by neighborhood</p>
                </div>

                <div class="stats">
                    <div class="stat-card" style="--accent: var(--green)">
                        <div class="stat-label">City Average AQI</div>
                        <div class="stat-value">68</div>
                        <span class="status status-good"><span class="status-dot"></span>Good</span>
                    </div>
                    <div class="stat-card" style="--accent: var(--blue)">
                        <div class="stat-label">Best Area</div>
                        <div class="stat-value">Riverside</div>
                        <div style="font-size: 0.9rem; color: var(--text-dim); margin-top: 0.5rem;">AQI: 42</div>
                    </div>
                    <div class="stat-card" style="--accent: var(--orange)">
                        <div class="stat-label">Worst Area</div>
                        <div class="stat-value">Industrial</div>
                        <div style="font-size: 0.9rem; color: var(--text-dim); margin-top: 0.5rem;">AQI: 156</div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">üè≠ Neighborhood Air Quality</h3>
                    </div>
                    <ul class="list" id="airList"></ul>
                    <form id="airForm">
                        <div class="form-group">
                            <label class="form-label">Subscribe to Alerts</label>
                            <select class="form-select">
                                <option>Select neighborhood...</option>
                                <option>Downtown</option>
                                <option>Riverside</option>
                                <option>Industrial Zone</option>
                                <option>Suburbs</option>
                            </select>
                        </div>
                        <button type="submit" class="btn btn-success">Enable Alerts</button>
                    </form>
                </div>
            </section>

            <!-- EMERGENCY -->
            <section id="emergency" class="section">
                <div class="header">
                    <h1 class="title">Emergency Management</h1>
                    <p class="subtitle">Real-time emergency response</p>
                </div>

                <div class="stats">
                    <div class="stat-card" style="--accent: var(--red)">
                        <div class="stat-label">Active Emergencies</div>
                        <div class="stat-value">3</div>
                    </div>
                    <div class="stat-card" style="--accent: var(--green)">
                        <div class="stat-label">Resolved Today</div>
                        <div class="stat-value">12</div>
                    </div>
                    <div class="stat-card" style="--accent: var(--blue)">
                        <div class="stat-label">Avg Response</div>
                        <div class="stat-value">8.5 min</div>
                    </div>
                </div>

                <div class="alert alert-danger">
                    <span class="alert-icon">üö®</span>
                    <div>
                        <div class="alert-title">Critical Alert</div>
                        <div>Fire on Mill Street. Emergency services dispatched.</div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">üö® Active Emergencies</h3>
                    </div>
                    <ul class="list" id="emergencyList"></ul>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Report Emergency</h3>
                    </div>
                    <form id="emergencyForm">
                        <div class="form-group">
                            <label class="form-label">Type *</label>
                            <select class="form-select" required>
                                <option>Select type...</option>
                                <option>Fire</option>
                                <option>Accident</option>
                                <option>Flood</option>
                                <option>Medical</option>
                                <option>Other</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Location *</label>
                            <input type="text" class="form-input" placeholder="Exact location..." required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Description *</label>
                            <textarea class="form-textarea" placeholder="Describe emergency..." required></textarea>
                        </div>
                        <button type="submit" class="btn btn-danger">üö® Report Emergency</button>
                    </form>
                </div>
            </section>

            <!-- CITIZEN REPORTS -->
            <section id="citizen" class="section">
                <div class="header">
                    <h1 class="title">Citizen Reports</h1>
                    <p class="subtitle">Community issue tracking</p>
                </div>

                <div class="stats">
                    <div class="stat-card" style="--accent: var(--purple)">
                        <div class="stat-label">Total Reports</div>
                        <div class="stat-value" id="totalReportsCount">1,247</div>
                    </div>
                    <div class="stat-card" style="--accent: var(--green)">
                        <div class="stat-label">Resolved</div>
                        <div class="stat-value" id="resolvedReportsCount">892</div>
                    </div>
                    <div class="stat-card" style="--accent: var(--orange)">
                        <div class="stat-label">In Progress</div>
                        <div class="stat-value" id="inProgressReportsCount">248</div>
                    </div>
                    <div class="stat-card" style="--accent: var(--blue)">
                        <div class="stat-label">Pending</div>
                        <div class="stat-value" id="pendingReportsCount">107</div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">üó£Ô∏è Top Issues</h3>
                    </div>
                    <ul class="list" id="citizenList"></ul>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Submit New Issue</h3>
                    </div>
                    <form id="citizenForm">
                        <div class="form-group">
                            <label class="form-label">Category *</label>
                            <select class="form-select" required>
                                <option>Select category...</option>
                                <option>Infrastructure</option>
                                <option>Safety</option>
                                <option>Cleanliness</option>
                                <option>Noise</option>
                                <option>Lighting</option>
                                <option>Other</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Title *</label>
                            <input type="text" class="form-input" placeholder="Brief title..." required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Location *</label>
                            <input type="text" class="form-input" placeholder="Where is this?" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Description *</label>
                            <textarea class="form-textarea" placeholder="Details..." required></textarea>
                        </div>
                        <button type="submit" class="btn btn-primary">Submit Issue</button>
                    </form>
                </div>
            </section>

            <!-- WEATHER -->
            <section id="weather" class="section">
                <div class="header">
                    <h1 class="title">Weather Monitoring</h1>
                    <p class="subtitle">Real-time weather data</p>
                </div>

                <div class="stats">
                    <div class="stat-card" style="--accent: var(--blue)">
                        <div class="stat-label">Temperature</div>
                        <div class="stat-value">72¬∞F</div>
                    </div>
                    <div class="stat-card" style="--accent: var(--cyan)">
                        <div class="stat-label">Humidity</div>
                        <div class="stat-value">65%</div>
                    </div>
                    <div class="stat-card" style="--accent: var(--green)">
                        <div class="stat-label">Wind Speed</div>
                        <div class="stat-value">12 mph</div>
                    </div>
                    <div class="stat-card" style="--accent: var(--orange)">
                        <div class="stat-label">Precipitation</div>
                        <div class="stat-value">20%</div>
                    </div>
                </div>

                <div class="alert alert-warning">
                    <span class="alert-icon">‚ö†Ô∏è</span>
                    <div>
                        <div class="alert-title">Weather Alert</div>
                        <div>Thunderstorm warning 6 PM - 10 PM tonight</div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">üå§Ô∏è 7-Day Forecast</h3>
                    </div>
                    <table>
                        <thead><tr><th>Day</th><th>Condition</th><th>High/Low</th><th>Precip</th></tr></thead>
                        <tbody id="forecastTable"></tbody>
                    </table>
                </div>
            </section>

            <!-- UTILITIES -->
            <section id="utilities" class="section">
                <div class="header">
                    <h1 class="title">Utility Services</h1>
                    <p class="subtitle">Monitor and report outages</p>
                </div>

                <div class="stats">
                    <div class="stat-card" style="--accent: var(--green)">
                        <div class="stat-label">Electricity</div>
                        <span class="status status-good"><span class="status-dot"></span>Operational</span>
                    </div>
                    <div class="stat-card" style="--accent: var(--blue)">
                        <div class="stat-label">Water</div>
                        <span class="status status-good"><span class="status-dot"></span>Operational</span>
                    </div>
                    <div class="stat-card" style="--accent: var(--orange)">
                        <div class="stat-label">Internet</div>
                        <span class="status status-warning"><span class="status-dot"></span>2 Areas Affected</span>
                    </div>
                    <div class="stat-card" style="--accent: var(--purple)">
                        <div class="stat-label">Gas</div>
                        <span class="status status-good"><span class="status-dot"></span>Operational</span>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">üîå Active Outages</h3>
                    </div>
                    <ul class="list" id="utilityList"></ul>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Report Outage</h3>
                    </div>
                    <form id="utilityForm">
                        <div class="form-group">
                            <label class="form-label">Utility Type *</label>
                            <select class="form-select" required>
                                <option>Select utility...</option>
                                <option>Electricity</option>
                                <option>Water</option>
                                <option>Internet</option>
                                <option>Gas</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Location *</label>
                            <input type="text" class="form-input" placeholder="Your location..." required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Description</label>
                            <textarea class="form-textarea" placeholder="Details..."></textarea>
                        </div>
                        <button type="submit" class="btn btn-primary">Report Outage</button>
                    </form>
                </div>
            </section>

            <!-- PARKING -->
            <section id="parking" class="section">
                <div class="header">
                    <h1 class="title">Parking Availability</h1>
                    <p class="subtitle">Find available parking spots</p>
                </div>

                <div class="stats">
                    <div class="stat-card" style="--accent: var(--blue)">
                        <div class="stat-label">Available Spots</div>
                        <div class="stat-value">1,247</div>
                    </div>
                    <div class="stat-card" style="--accent: var(--green)">
                        <div class="stat-label">Occupancy Rate</div>
                        <div class="stat-value">68%</div>
                        <div class="progress"><div class="progress-bar" style="width: 68%"></div></div>
                    </div>
                    <div class="stat-card" style="--accent: var(--purple)">
                        <div class="stat-label">Avg. Price</div>
                        <div class="stat-value">$2.50/hr</div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">üÖøÔ∏è Nearby Parking</h3>
                    </div>
                    <ul class="list" id="parkingList"></ul>
                    <form id="parkingForm">
                        <div class="form-group">
                            <label class="form-label">Find Parking Near</label>
                            <input type="text" class="form-input" placeholder="Destination...">
                        </div>
                        <button type="submit" class="btn btn-primary">Search</button>
                    </form>
                </div>
            </section>

            <!-- EVENTS -->
            <section id="events" class="section">
                <div class="header">
                    <h1 class="title">City Events</h1>
                    <p class="subtitle">Upcoming events and crowd predictions</p>
                </div>

                <div class="stats">
                    <div class="stat-card" style="--accent: var(--purple)">
                        <div class="stat-label">Upcoming</div>
                        <div class="stat-value">24</div>
                    </div>
                    <div class="stat-card" style="--accent: var(--orange)">
                        <div class="stat-label">Today</div>
                        <div class="stat-value">3</div>
                    </div>
                    <div class="stat-card" style="--accent: var(--blue)">
                        <div class="stat-label">This Week</div>
                        <div class="stat-value">12</div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">üìÖ Upcoming Events</h3>
                    </div>
                    <ul class="list" id="eventsList"></ul>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Add Event</h3>
                    </div>
                    <form id="eventsForm">
                        <div class="form-group">
                            <label class="form-label">Event Name *</label>
                            <input type="text" class="form-input" placeholder="Name..." required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Date & Time *</label>
                            <input type="datetime-local" class="form-input" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Location *</label>
                            <input type="text" class="form-input" placeholder="Location..." required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Crowd Size</label>
                            <select class="form-select">
                                <option>Small (< 100)</option>
                                <option>Medium (100-500)</option>
                                <option>Large (500-2000)</option>
                                <option>Very Large (2000+)</option>
                            </select>
                        </div>
                        <button type="submit" class="btn btn-primary">Submit Event</button>
                    </form>
                </div>
            </section>

            <!-- NOISE -->
            <section id="noise" class="section">
                <div class="header">
                    <h1 class="title">Noise Level Monitoring</h1>
                    <p class="subtitle">Track noise pollution</p>
                </div>

                <div class="stats">
                    <div class="stat-card" style="--accent: var(--green)">
                        <div class="stat-label">City Average</div>
                        <div class="stat-value">58 dB</div>
                    </div>
                    <div class="stat-card" style="--accent: var(--blue)">
                        <div class="stat-label">Quietest</div>
                        <div class="stat-value">Residential</div>
                        <div style="font-size: 0.9rem; color: var(--text-dim); margin-top: 0.5rem;">45 dB</div>
                    </div>
                    <div class="stat-card" style="--accent: var(--red)">
                        <div class="stat-label">Loudest</div>
                        <div class="stat-value">Highway</div>
                        <div style="font-size: 0.9rem; color: var(--text-dim); margin-top: 0.5rem;">82 dB</div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">üîä Noise Levels by Area</h3>
                    </div>
                    <ul class="list" id="noiseList"></ul>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Report Noise</h3>
                    </div>
                    <form id="noiseForm">
                        <div class="form-group">
                            <label class="form-label">Type *</label>
                            <select class="form-select" required>
                                <option>Select type...</option>
                                <option>Construction</option>
                                <option>Traffic</option>
                                <option>Neighbor</option>
                                <option>Event/Party</option>
                                <option>Industrial</option>
                                <option>Other</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Location *</label>
                            <input type="text" class="form-input" placeholder="Location..." required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Description *</label>
                            <textarea class="form-textarea" placeholder="Describe..." required></textarea>
                        </div>
                        <button type="submit" class="btn btn-primary">Submit</button>
                    </form>
                </div>
            </section>

            <!-- WASTE -->
            <section id="waste" class="section">
                <div class="header">
                    <h1 class="title">Waste Management</h1>
                    <p class="subtitle">Collection schedules</p>
                </div>

                <div class="alert alert-info">
                    <span class="alert-icon">üì¢</span>
                    <div>
                        <div class="alert-title">Next Pickup</div>
                        <div>Regular waste tomorrow at 7:00 AM</div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">üóëÔ∏è Collection Schedule</h3>
                    </div>
                    <ul class="list" id="wasteList"></ul>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">Report Issue</h3>
                    </div>
                    <form id="wasteForm">
                        <div class="form-group">
                            <label class="form-label">Issue *</label>
                            <select class="form-select" required>
                                <option>Select issue...</option>
                                <option>Missed Pickup</option>
                                <option>Illegal Dumping</option>
                                <option>Overflowing Bins</option>
                                <option>Damaged Container</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Location *</label>
                            <input type="text" class="form-input" placeholder="Location..." required>
                        </div>
                        <button type="submit" class="btn btn-primary">Report</button>
                    </form>
                </div>
            </section>

            <!-- CRIME -->
            <section id="crime" class="section">
                <div class="header">
                    <h1 class="title">Crime & Safety</h1>
                    <p class="subtitle">Crime statistics and safety zones</p>
                </div>

                <div class="stats">
                    <div class="stat-card" style="--accent: var(--green)">
                        <div class="stat-label">Crime Rate Change</div>
                        <div class="stat-value">-12%</div>
                        <span class="stat-change positive">‚Üì vs Last Week</span>
                    </div>
                    <div class="stat-card" style="--accent: var(--red)">
                        <div class="stat-label">This Week</div>
                        <div class="stat-value">23</div>
                    </div>
                    <div class="stat-card" style="--accent: var(--blue)">
                        <div class="stat-label">This Month</div>
                        <div class="stat-value">87</div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">üõ°Ô∏è Safety by Neighborhood</h3>
                    </div>
                    <ul class="list" id="crimeList"></ul>
                </div>
            </section>

            <!-- SENSORS -->
            <section id="sensors" class="section">
                <div class="header">
                    <h1 class="title">Smart City Sensors</h1>
                    <p class="subtitle">IoT sensor network status</p>
                </div>

                <div class="stats">
                    <div class="stat-card" style="--accent: var(--blue)">
                        <div class="stat-label">Total Sensors</div>
                        <div class="stat-value">3,247</div>
                    </div>
                    <div class="stat-card" style="--accent: var(--green)">
                        <div class="stat-label">Online</div>
                        <div class="stat-value">3,192</div>
                        <span class="stat-change positive">98.3%</span>
                    </div>
                    <div class="stat-card" style="--accent: var(--red)">
                        <div class="stat-label">Offline</div>
                        <div class="stat-value">55</div>
                    </div>
                    <div class="stat-card" style="--accent: var(--orange)">
                        <div class="stat-label">Maintenance</div>
                        <div class="stat-value">12</div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">üì° Sensor Status</h3>
                    </div>
                    <ul class="list" id="sensorsList"></ul>
                </div>

                <div class="alert alert-warning">
                    <span class="alert-icon">üîß</span>
                    <div>
                        <div class="alert-title">Maintenance Alert</div>
                        <div>3 streetlight sensors offline on Elm Street</div>
                    </div>
                </div>
            </section>

            <!-- POLLS -->
            <section id="polls" class="section">
                <div class="header">
                    <h1 class="title">Community Polls</h1>
                    <p class="subtitle">Participate in community decisions</p>
                </div>

                <div class="stats">
                    <div class="stat-card" style="--accent: var(--purple)">
                        <div class="stat-label">Active Polls</div>
                        <div class="stat-value">8</div>
                    </div>
                    <div class="stat-card" style="--accent: var(--blue)">
                        <div class="stat-label">Your Votes</div>
                        <div class="stat-value">12</div>
                    </div>
                    <div class="stat-card" style="--accent: var(--green)">
                        <div class="stat-label">Participants</div>
                        <div class="stat-value">4,892</div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">üó≥Ô∏è Active Polls</h3>
                    </div>
                    <div id="pollsList"></div>
                    <button class="btn btn-primary" id="votePollBtn" style="width: 100%; margin-top: 1rem;">Submit Votes</button>
                </div>
            </section>

            <!-- REAL-TIME MONITORING -->
            <section id="monitoring" class="section">
                <div class="header">
                    <h1 class="title">Real-time Monitoring</h1>
                    <p class="subtitle">Live traffic predictions & environmental data</p>
                </div>

                <div class="grid" style="grid-template-columns: 1fr 1fr;">
                    <!-- TRAFFIC MONITORING WITH ML -->
                    <div class="card" style="grid-column: span 1;">
                        <div class="card-header">
                            <h3 class="card-title">üöó Traffic Flow & ML Predictions</h3>
                            <span class="status status-good">
                                <span class="status-dot"></span>Live
                            </span>
                        </div>

                        <div class="stats" style="grid-template-columns: 1fr 1fr; margin-bottom: 1.5rem;">
                            <div class="stat-card" style="--accent: var(--blue);">
                                <div class="stat-label">Current Flow</div>
                                <div class="stat-value" id="currentFlow">72%</div>
                                <span class="stat-change positive">‚Üë 5%</span>
                            </div>
                            <div class="stat-card" style="--accent: var(--purple);">
                                <div class="stat-label">Predicted (30 min)</div>
                                <div class="stat-value" id="predictedFlow">65%</div>
                                <span class="stat-change negative">‚Üì 7%</span>
                            </div>
                        </div>

                        <div style="margin-bottom: 1.5rem;">
                            <canvas id="trafficPredictionChart" style="max-height: 250px;"></canvas>
                        </div>

                        <div class="alert alert-info" style="margin-bottom: 1rem;">
                            <span class="alert-icon">ü§ñ</span>
                            <div>
                                <div class="alert-title">ML Model Prediction</div>
                                <div>Congestion expected on Main St in 25 minutes. Accuracy: 94.2%</div>
                            </div>
                        </div>

                        <div>
                            <h4 style="font-size: 0.95rem; font-weight: 700; margin-bottom: 1rem; color: var(--text-dim);">Live Traffic Status</h4>
                            <ul class="list" id="trafficMonitorList">
                                <li class="list-item">
                                    <div class="list-info">
                                        <div class="list-icon">üöó</div>
                                        <div>
                                            <div class="list-title">Main Street</div>
                                            <div class="list-meta">Current: 65% flow ‚Ä¢ Predicted: 45% in 30min</div>
                                        </div>
                                    </div>
                                    <span class="status status-warning">
                                        <span class="status-dot"></span>Moderate
                                    </span>
                                </li>
                                <li class="list-item">
                                    <div class="list-info">
                                        <div class="list-icon">üõ£Ô∏è</div>
                                        <div>
                                            <div class="list-title">Highway 101</div>
                                            <div class="list-meta">Current: 90% flow ‚Ä¢ Predicted: 88% in 30min</div>
                                        </div>
                                    </div>
                                    <span class="status status-good">
                                        <span class="status-dot"></span>Light
                                    </span>
                                </li>
                                <li class="list-item">
                                    <div class="list-info">
                                        <div class="list-icon">üèôÔ∏è</div>
                                        <div>
                                            <div class="list-title">Downtown</div>
                                            <div class="list-meta">Current: 35% flow ‚Ä¢ Predicted: 28% in 30min</div>
                                        </div>
                                    </div>
                                    <span class="status status-danger">
                                        <span class="status-dot"></span>Heavy
                                    </span>
                                </li>
                            </ul>
                        </div>
                    </div>

                    <!-- ENVIRONMENTAL SENSORS -->
                    <div class="card" style="grid-column: span 1;">
                        <div class="card-header">
                            <h3 class="card-title">üåç Environmental Sensors & Forecast</h3>
                            <span class="status status-good">
                                <span class="status-dot"></span>Active
                            </span>
                        </div>

                        <div class="stats" style="grid-template-columns: 1fr 1fr; margin-bottom: 1.5rem;">
                            <div class="stat-card" style="--accent: var(--green);">
                                <div class="stat-label">Air Quality Index</div>
                                <div class="stat-value" id="currentAQI">68</div>
                                <span class="stat-change positive">‚Üì 12 Good</span>
                            </div>
                            <div class="stat-card" style="--accent: var(--cyan);">
                                <div class="stat-label">Temperature</div>
                                <div class="stat-value" id="currentTemp">72¬∞F</div>
                                <span class="stat-change">Feels like 70¬∞F</span>
                            </div>
                        </div>

                        <div style="margin-bottom: 1.5rem;">
                            <canvas id="environmentalChart" style="max-height: 250px;"></canvas>
                        </div>

                        <div class="alert alert-warning" style="margin-bottom: 1rem;">
                            <span class="alert-icon">‚ö†Ô∏è</span>
                            <div>
                                <div class="alert-title">Weather Alert</div>
                                <div>Thunderstorm warning from 6 PM to 10 PM tonight</div>
                            </div>
                        </div>

                        <div>
                            <h4 style="font-size: 0.95rem; font-weight: 700; margin-bottom: 1rem; color: var(--text-dim);">Sensor Readings</h4>
                            <ul class="list" id="environmentalSensorList">
                                <li class="list-item">
                                    <div class="list-info">
                                        <div class="list-icon">üí®</div>
                                        <div>
                                            <div class="list-title">Air Quality - Downtown</div>
                                            <div class="list-meta">AQI: 85 ‚Ä¢ Forecast: 78 (6hrs)</div>
                                        </div>
                                    </div>
                                    <span class="status status-warning">
                                        <span class="status-dot"></span>Moderate
                                    </span>
                                </li>
                                <li class="list-item">
                                    <div class="list-info">
                                        <div class="list-icon">üå°Ô∏è</div>
                                        <div>
                                            <div class="list-title">Temperature & Humidity</div>
                                            <div class="list-meta">72¬∞F ‚Ä¢ 65% humidity ‚Ä¢ Forecast: 68¬∞F</div>
                                        </div>
                                    </div>
                                    <span class="status status-good">
                                        <span class="status-dot"></span>Normal
                                    </span>
                                </li>
                                <li class="list-item">
                                    <div class="list-info">
                                        <div class="list-icon">‚òÅÔ∏è</div>
                                        <div>
                                            <div class="list-title">Weather Conditions</div>
                                            <div class="list-meta">Partly Cloudy ‚Ä¢ Wind: 8 mph NE</div>
                                        </div>
                                    </div>
                                    <span class="status status-good">
                                        <span class="status-dot"></span>Stable
                                    </span>
                                </li>
                                <li class="list-item">
                                    <div class="list-info">
                                        <div class="list-icon">üåä</div>
                                        <div>
                                            <div class="list-title">Precipitation</div>
                                            <div class="list-meta">0% now ‚Ä¢ Forecast: 70% at 6 PM</div>
                                        </div>
                                    </div>
                                    <span class="status status-warning">
                                        <span class="status-dot"></span>Watch
                                    </span>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- 24-Hour Forecast Grid -->
                <div class="card" style="margin-top: 1.5rem;">
                    <div class="card-header">
                        <h3 class="card-title">üìä 24-Hour Integrated Forecast</h3>
                    </div>
                    <div style="overflow-x: auto;">
                        <table>
                            <thead>
                                <tr>
                                    <th>Time</th>
                                    <th>Traffic Flow</th>
                                    <th>ML Prediction</th>
                                    <th>AQI</th>
                                    <th>Weather</th>
                                    <th>Temperature</th>
                                </tr>
                            </thead>
                            <tbody id="forecastIntegratedTable">
                                <tr>
                                    <td>Now</td>
                                    <td>72%</td>
                                    <td><span class="status status-good">Normal</span></td>
                                    <td>68</td>
                                    <td>Partly Cloudy</td>
                                    <td>72¬∞F</td>
                                </tr>
                                <tr>
                                    <td>3:00 PM</td>
                                    <td>65%</td>
                                    <td><span class="status status-warning">Moderate</span></td>
                                    <td>75</td>
                                    <td>Cloudy</td>
                                    <td>70¬∞F</td>
                                </tr>
                                <tr>
                                    <td>6:00 PM</td>
                                    <td>45%</td>
                                    <td><span class="status status-danger">Congestion</span></td>
                                    <td>82</td>
                                    <td>Rain</td>
                                    <td>68¬∞F</td>
                                </tr>
                                <tr>
                                    <td>9:00 PM</td>
                                    <td>78%</td>
                                    <td><span class="status status-good">Light</span></td>
                                    <td>72</td>
                                    <td>Clearing</td>
                                    <td>65¬∞F</td>
                                </tr>
                                <tr>
                                    <td>12:00 AM</td>
                                    <td>92%</td>
                                    <td><span class="status status-good">Light</span></td>
                                    <td>58</td>
                                    <td>Clear</td>
                                    <td>62¬∞F</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>

            <!-- BUDGET -->
            <section id="budget" class="section">
                <div class="header">
                    <h1 class="title">City Budget Tracker</h1>
                    <p class="subtitle">Transparent budget allocation</p>
                </div>

                <div class="stats">
                    <div class="stat-card" style="--accent: var(--blue)">
                        <div class="stat-label">Total Budget FY 2026</div>
                        <div class="stat-value">$127.5M</div>
                    </div>
                    <div class="stat-card" style="--accent: var(--green)">
                        <div class="stat-label">Allocated</div>
                        <div class="stat-value">68%</div>
                        <div class="progress"><div class="progress-bar" style="width: 68%"></div></div>
                    </div>
                    <div class="stat-card" style="--accent: var(--orange)">
                        <div class="stat-label">Spent This Quarter</div>
                        <div class="stat-value">$28.3M</div>
                    </div>
                    <div class="stat-card" style="--accent: var(--purple)">
                        <div class="stat-label">Remaining</div>
                        <div class="stat-value">$40.8M</div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">üí∞ Budget by Department</h3>
                    </div>
                    <table>
                        <thead><tr><th>Department</th><th>Allocated</th><th>Spent</th><th>Remaining</th><th>% Total</th></tr></thead>
                        <tbody id="budgetTable"></tbody>
                    </table>
                </div>

                <div class="alert alert-success">
                    <span class="alert-icon">üìä</span>
                    <div>
                        <div class="alert-title">Budget Update</div>
                        <div>Spending on track. 3 projects under budget.</div>
                    </div>
                </div>
            </section>

            <!-- GPS REPORTING -->
            <section id="gps-reporting" class="section">
                <div class="header">
                    <h1 class="title">GPS Reporting</h1>
                    <p class="subtitle">Real-time location tracking and field reporting</p>
                </div>

                <div class="stats">
                    <div class="stat-card" style="--accent: var(--green)">
                        <div class="stat-label">Active GPS Devices</div>
                        <div class="stat-value" id="activeGPS">24</div>
                        <span class="stat-change positive">‚Üë 3 Today</span>
                    </div>
                    <div class="stat-card" style="--accent: var(--blue)">
                        <div class="stat-label">Reports Submitted</div>
                        <div class="stat-value" id="gpsReports">156</div>
                        <span class="stat-change positive">‚Üë 12 Today</span>
                    </div>
                    <div class="stat-card" style="--accent: var(--cyan)">
                        <div class="stat-label">Average Response Time</div>
                        <div class="stat-value">8.4min</div>
                        <span class="stat-change positive">‚Üì 1.2min</span>
                    </div>
                    <div class="stat-card" style="--accent: var(--purple)">
                        <div class="stat-label">Coverage Area</div>
                        <div class="stat-value">94%</div>
                        <div class="progress"><div class="progress-bar" style="width: 94%"></div></div>
                    </div>
                </div>

                <div class="grid">
                    <!-- LIVE GPS MAP -->
                    <div class="card" style="grid-column: span 2;">
                        <div class="card-header">
                            <h3 class="card-title">üìç Live GPS Tracking Map</h3>
                            <span class="status status-good">
                                <span class="status-dot"></span>24 Active
                            </span>
                        </div>
                        <div id="gpsMap" style="width: 100%; height: 400px; background: var(--bg-tertiary); border-radius: 8px; position: relative;">
                            <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); text-align: center; color: var(--text-dim);">
                                <div style="font-size: 3rem; margin-bottom: 1rem;">üó∫Ô∏è</div>
                                <div style="font-weight: 600;">GPS Map Loading...</div>
                                <div style="font-size: 0.875rem; margin-top: 0.5rem;">Interactive map will display here</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="grid">
                    <!-- ACTIVE FIELD AGENTS -->
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">üë• Active Field Agents</h3>
                        </div>
                        <ul class="list" id="gpsAgentsList">
                            <li class="list-item">
                                <div class="list-info">
                                    <div class="list-icon" style="background: rgba(16, 185, 129, 0.15);">üöì</div>
                                    <div>
                                        <div class="list-title">Officer Martinez</div>
                                        <div class="list-meta">Downtown Patrol ‚Ä¢ Last update: 2 min ago</div>
                                        <div class="list-meta" style="margin-top: 0.25rem; color: var(--text-dim); font-size: 0.8rem;">
                                            üìç Lat: 34.0522, Lon: -118.2437
                                        </div>
                                    </div>
                                </div>
                                <span class="status status-good">
                                    <span class="status-dot"></span>Active
                                </span>
                            </li>
                            <li class="list-item">
                                <div class="list-info">
                                    <div class="list-icon" style="background: rgba(16, 185, 129, 0.15);">üöí</div>
                                    <div>
                                        <div class="list-title">Fire Unit 12</div>
                                        <div class="list-meta">North District ‚Ä¢ Last update: 1 min ago</div>
                                        <div class="list-meta" style="margin-top: 0.25rem; color: var(--text-dim); font-size: 0.8rem;">
                                            üìç Lat: 34.0689, Lon: -118.2445
                                        </div>
                                    </div>
                                </div>
                                <span class="status status-good">
                                    <span class="status-dot"></span>Active
                                </span>
                            </li>
                            <li class="list-item">
                                <div class="list-info">
                                    <div class="list-icon" style="background: rgba(16, 185, 129, 0.15);">üöë</div>
                                    <div>
                                        <div class="list-title">Ambulance A-7</div>
                                        <div class="list-meta">En Route to Memorial Hospital ‚Ä¢ Last update: 30 sec ago</div>
                                        <div class="list-meta" style="margin-top: 0.25rem; color: var(--text-dim); font-size: 0.8rem;">
                                            üìç Lat: 34.0412, Lon: -118.2468
                                        </div>
                                    </div>
                                </div>
                                <span class="status status-good">
                                    <span class="status-dot"></span>Active
                                </span>
                            </li>
                            <li class="list-item">
                                <div class="list-info">
                                    <div class="list-icon" style="background: rgba(16, 185, 129, 0.15);">üîß</div>
                                    <div>
                                        <div class="list-title">Utility Crew 3</div>
                                        <div class="list-meta">Power Line Maintenance ‚Ä¢ Last update: 5 min ago</div>
                                        <div class="list-meta" style="margin-top: 0.25rem; color: var(--text-dim); font-size: 0.8rem;">
                                            üìç Lat: 34.0578, Lon: -118.2512
                                        </div>
                                    </div>
                                </div>
                                <span class="status status-good">
                                    <span class="status-dot"></span>Active
                                </span>
                            </li>
                            <li class="list-item">
                                <div class="list-info">
                                    <div class="list-icon" style="background: rgba(245, 158, 11, 0.15); color: var(--orange);">üöõ</div>
                                    <div>
                                        <div class="list-title">Waste Collection 5</div>
                                        <div class="list-meta">South District Route ‚Ä¢ Last update: 12 min ago</div>
                                        <div class="list-meta" style="margin-top: 0.25rem; color: var(--text-dim); font-size: 0.8rem;">
                                            üìç Lat: 34.0324, Lon: -118.2401
                                        </div>
                                    </div>
                                </div>
                                <span class="status status-warning">
                                    <span class="status-dot"></span>Delayed
                                </span>
                            </li>
                        </ul>
                    </div>

                    <!-- RECENT GPS REPORTS -->
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">üìã Recent GPS Reports</h3>
                        </div>
                        <ul class="list" id="gpsReportsList">
                            <li class="list-item">
                                <div class="list-info">
                                    <div class="list-icon" style="background: rgba(239, 68, 68, 0.15); color: var(--red);">‚ö†Ô∏è</div>
                                    <div>
                                        <div class="list-title">Pothole Reported</div>
                                        <div class="list-meta">Main St & 5th Ave ‚Ä¢ Submitted: 15 min ago</div>
                                        <div class="list-meta" style="margin-top: 0.25rem; color: var(--text-dim); font-size: 0.8rem;">
                                            By: Inspector Chen
                                        </div>
                                    </div>
                                </div>
                                <span class="status status-danger">
                                    <span class="status-dot"></span>Urgent
                                </span>
                            </li>
                            <li class="list-item">
                                <div class="list-info">
                                    <div class="list-icon" style="background: rgba(16, 185, 129, 0.15);">‚úì</div>
                                    <div>
                                        <div class="list-title">Street Light Repaired</div>
                                        <div class="list-meta">Oak Avenue ‚Ä¢ Completed: 1 hour ago</div>
                                        <div class="list-meta" style="margin-top: 0.25rem; color: var(--text-dim); font-size: 0.8rem;">
                                            By: Utility Crew 2
                                        </div>
                                    </div>
                                </div>
                                <span class="status status-good">
                                    <span class="status-dot"></span>Complete
                                </span>
                            </li>
                            <li class="list-item">
                                <div class="list-info">
                                    <div class="list-icon" style="background: rgba(59, 130, 246, 0.15);">üì∏</div>
                                    <div>
                                        <div class="list-title">Graffiti Documentation</div>
                                        <div class="list-meta">Park Plaza ‚Ä¢ Submitted: 2 hours ago</div>
                                        <div class="list-meta" style="margin-top: 0.25rem; color: var(--text-dim); font-size: 0.8rem;">
                                            By: Officer Rodriguez
                                        </div>
                                    </div>
                                </div>
                                <span class="status status-warning">
                                    <span class="status-dot"></span>Pending
                                </span>
                            </li>
                            <li class="list-item">
                                <div class="list-info">
                                    <div class="list-icon" style="background: rgba(16, 185, 129, 0.15);">üå≥</div>
                                    <div>
                                        <div class="list-title">Tree Trimming Complete</div>
                                        <div class="list-meta">Lincoln Park ‚Ä¢ Completed: 3 hours ago</div>
                                        <div class="list-meta" style="margin-top: 0.25rem; color: var(--text-dim); font-size: 0.8rem;">
                                            By: Parks Team Alpha
                                        </div>
                                    </div>
                                </div>
                                <span class="status status-good">
                                    <span class="status-dot"></span>Complete
                                </span>
                            </li>
                            <li class="list-item">
                                <div class="list-info">
                                    <div class="list-icon" style="background: rgba(245, 158, 11, 0.15); color: var(--orange);">üöß</div>
                                    <div>
                                        <div class="list-title">Road Construction Update</div>
                                        <div class="list-meta">Highway Interchange ‚Ä¢ Submitted: 4 hours ago</div>
                                        <div class="list-meta" style="margin-top: 0.25rem; color: var(--text-dim); font-size: 0.8rem;">
                                            By: Construction Supervisor
                                        </div>
                                    </div>
                                </div>
                                <span class="status status-warning">
                                    <span class="status-dot"></span>In Progress
                                </span>
                            </li>
                        </ul>
                    </div>
                </div>

                <!-- MOBILE APP PREVIEW -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">üì± Mobile App Preview</h3>
                    </div>
                    <div class="mobile-preview">
                        <div class="mobile-screen">
                            <div class="mobile-header">
                                <div style="display: flex; align-items: center; justify-content: center; gap: 0.5rem;">
                                    <span>üìç</span> PulseCity GPS Reporter
                                </div>
                            </div>
                            <div class="mobile-content">
                                <div class="gps-indicator">
                                    <div class="gps-pulse"></div>
                                    <div style="flex: 1;">
                                        <div style="font-weight: 700; margin-bottom: 0.25rem;">GPS Active</div>
                                        <div style="font-size: 0.85rem; opacity: 0.8;">Location: Downtown (34.0522, -118.2437)</div>
                                    </div>
                                </div>

                                <div style="background: var(--bg-tertiary); padding: 1.25rem; border-radius: 8px; margin-bottom: 1rem;">
                                    <div style="font-weight: 700; margin-bottom: 1rem; font-size: 0.95rem;">Quick Report</div>
                                    <div class="form-group" style="margin-bottom: 0.75rem;">
                                        <label class="form-label" style="font-size: 0.8rem;">Report Type</label>
                                        <select class="form-select" style="padding: 0.5rem; font-size: 0.85rem;">
                                            <option>Pothole</option>
                                            <option>Street Light Out</option>
                                            <option>Graffiti</option>
                                            <option>Illegal Dumping</option>
                                            <option>Traffic Hazard</option>
                                            <option>Other</option>
                                        </select>
                                    </div>
                                    <div class="form-group" style="margin-bottom: 0.75rem;">
                                        <label class="form-label" style="font-size: 0.8rem;">Description</label>
                                        <textarea class="form-textarea" rows="3" style="padding: 0.5rem; font-size: 0.85rem; min-height: 60px;" placeholder="Describe the issue..."></textarea>
                                    </div>
                                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.5rem; margin-bottom: 0.75rem;">
                                        <button class="btn btn-primary" style="padding: 0.5rem; font-size: 0.85rem;">üì∏ Photo</button>
                                        <button class="btn btn-primary" style="padding: 0.5rem; font-size: 0.85rem;">üéôÔ∏è Voice</button>
                                    </div>
                                    <button class="btn btn-success" style="width: 100%; padding: 0.6rem; font-size: 0.9rem;">
                                        Submit Report
                                    </button>
                                </div>

                                <div style="background: rgba(59, 130, 246, 0.1); padding: 1rem; border-radius: 8px; border: 1px solid rgba(59, 130, 246, 0.3);">
                                    <div style="font-weight: 700; margin-bottom: 0.5rem; font-size: 0.85rem; color: var(--blue);">üìä Your Stats Today</div>
                                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.75rem; font-size: 0.85rem;">
                                        <div>
                                            <div style="color: var(--text-dim);">Reports</div>
                                            <div style="font-weight: 700; font-size: 1.25rem;">3</div>
                                        </div>
                                        <div>
                                            <div style="color: var(--text-dim);">Distance</div>
                                            <div style="font-weight: 700; font-size: 1.25rem;">12.4mi</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- GPS TRACKING STATISTICS -->
                <div class="grid">
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">üìà GPS Activity Today</h3>
                        </div>
                        <div style="padding: 1rem 0;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 1rem; padding-bottom: 0.75rem; border-bottom: 1px solid var(--border);">
                                <span style="color: var(--text-dim);">Total Distance Covered</span>
                                <span style="font-weight: 700; font-size: 1.1rem;">287.6 miles</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; margin-bottom: 1rem; padding-bottom: 0.75rem; border-bottom: 1px solid var(--border);">
                                <span style="color: var(--text-dim);">Reports with GPS Data</span>
                                <span style="font-weight: 700; font-size: 1.1rem;">142 / 156</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; margin-bottom: 1rem; padding-bottom: 0.75rem; border-bottom: 1px solid var(--border);">
                                <span style="color: var(--text-dim);">Average Update Frequency</span>
                                <span style="font-weight: 700; font-size: 1.1rem;">45 seconds</span>
                            </div>
                            <div style="display: flex; justify-content: space-between;">
                                <span style="color: var(--text-dim);">GPS Accuracy</span>
                                <span style="font-weight: 700; font-size: 1.1rem; color: var(--green);">¬±5 meters</span>
                            </div>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">üéØ Location Heatmap</h3>
                        </div>
                        <div style="background: var(--bg-tertiary); border-radius: 8px; padding: 1.5rem; text-align: center; min-height: 240px; display: flex; flex-direction: column; align-items: center; justify-content: center;">
                            <div style="font-size: 3rem; margin-bottom: 1rem;">üó∫Ô∏è</div>
                            <div style="font-weight: 600; margin-bottom: 0.5rem;">Activity Heatmap</div>
                            <div style="font-size: 0.875rem; color: var(--text-dim);">Most active areas highlighted in red</div>
                            <div style="margin-top: 1rem; display: flex; gap: 1rem; font-size: 0.8rem;">
                                <div><span style="color: var(--red);">‚óè</span> High Activity</div>
                                <div><span style="color: var(--orange);">‚óè</span> Medium</div>
                                <div><span style="color: var(--green);">‚óè</span> Low</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="alert alert-info">
                    <span class="alert-icon">‚ÑπÔ∏è</span>
                    <div>
                        <div class="alert-title">GPS System Status</div>
                        <div>All GPS devices are functioning normally. Last system check: 5 minutes ago. Next scheduled maintenance: Tomorrow at 2:00 AM.</div>
                    </div>
                </div>
            </section>

            <!-- Analytics & Reporting Section -->
            <section id="analytics" class="section">
                <div class="header">
                    <h1 class="title">Analytics & Reporting</h1>
                    <p class="subtitle">Comprehensive analytics with secure authentication and authorization</p>
                </div>

                <!-- Authentication & Authorization Cards -->
                <div class="grid">
                    <!-- Two-Factor Authentication Card -->
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">üîê Two-Factor Authentication (2FA)</h3>
                            <span class="status status-good">
                                <span class="status-dot"></span>Active
                            </span>
                        </div>
                        
                        <div style="margin-bottom: 1.5rem;">
                            <div class="alert alert-success" style="margin-bottom: 1rem;">
                                <span class="alert-icon">‚úì</span>
                                <div>
                                    <div class="alert-title">2FA Enabled</div>
                                    <div>Your account is protected with two-factor authentication</div>
                                </div>
                            </div>
                        </div>

                        <div style="margin-bottom: 1.5rem;">
                            <h4 style="font-weight: 700; margin-bottom: 1rem; font-size: 1rem;">Authentication Methods</h4>
                            <ul class="list">
                                <li class="list-item">
                                    <div class="list-info">
                                        <div class="list-icon" style="background: rgba(59, 130, 246, 0.15); color: var(--blue);">üì±</div>
                                        <div>
                                            <div class="list-title">Authenticator App</div>
                                            <div class="list-meta">Google Authenticator, Microsoft Authenticator</div>
                                        </div>
                                    </div>
                                    <span class="status status-good">
                                        <span class="status-dot"></span>Configured
                                    </span>
                                </li>
                                <li class="list-item">
                                    <div class="list-info">
                                        <div class="list-icon" style="background: rgba(16, 185, 129, 0.15); color: var(--green);">üìß</div>
                                        <div>
                                            <div class="list-title">Email Verification</div>
                                            <div class="list-meta"><a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="91f0f5fcf8ffd1e1e4fde2f4f2f8e5e8bff6fee7">[email&#160;protected]</a></div>
                                        </div>
                                    </div>
                                    <span class="status status-good">
                                        <span class="status-dot"></span>Active
                                    </span>
                                </li>
                                <li class="list-item">
                                    <div class="list-info">
                                        <div class="list-icon" style="background: rgba(139, 92, 246, 0.15); color: var(--purple);">üí¨</div>
                                        <div>
                                            <div class="list-title">SMS Verification</div>
                                            <div class="list-meta">+1 (555) XXX-1234</div>
                                        </div>
                                    </div>
                                    <span class="status status-warning">
                                        <span class="status-dot"></span>Backup
                                    </span>
                                </li>
                            </ul>
                        </div>

                        <div style="background: var(--bg-tertiary); padding: 1.25rem; border-radius: 8px; margin-bottom: 1rem;">
                            <h4 style="font-weight: 700; margin-bottom: 0.75rem; font-size: 0.95rem;">Recent Authentication Activity</h4>
                            <div style="display: flex; justify-content: space-between; align-items: center; padding: 0.75rem 0; border-bottom: 1px solid var(--border);">
                                <div>
                                    <div style="font-weight: 600; margin-bottom: 0.25rem;">Successful Login</div>
                                    <div style="font-size: 0.85rem; color: var(--text-dim);">2 minutes ago ‚Ä¢ Chrome on Windows</div>
                                </div>
                                <span style="color: var(--green); font-size: 1.25rem;">‚úì</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; align-items: center; padding: 0.75rem 0; border-bottom: 1px solid var(--border);">
                                <div>
                                    <div style="font-weight: 600; margin-bottom: 0.25rem;">Successful Login</div>
                                    <div style="font-size: 0.85rem; color: var(--text-dim);">Today at 9:15 AM ‚Ä¢ Mobile App (iOS)</div>
                                </div>
                                <span style="color: var(--green); font-size: 1.25rem;">‚úì</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; align-items: center; padding: 0.75rem 0;">
                                <div>
                                    <div style="font-weight: 600; margin-bottom: 0.25rem;">Failed Login Attempt</div>
                                    <div style="font-size: 0.85rem; color: var(--text-dim);">Yesterday at 11:32 PM ‚Ä¢ Unknown Device</div>
                                </div>
                                <span style="color: var(--red); font-size: 1.25rem;">‚úó</span>
                            </div>
                        </div>

                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.75rem;">
                            <button class="btn btn-primary">‚öôÔ∏è Configure 2FA</button>
                            <button class="btn" style="background: var(--bg-tertiary); color: var(--text);">üìã View Logs</button>
                        </div>
                    </div>

                    <!-- Role-Based Authorization Card -->
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">üë• Role-Based Authorization (RBAC)</h3>
                            <span class="status status-good">
                                <span class="status-dot"></span>Active
                            </span>
                        </div>

                        <div style="margin-bottom: 1.5rem;">
                            <div class="alert alert-info" style="margin-bottom: 1rem;">
                                <span class="alert-icon">‚ÑπÔ∏è</span>
                                <div>
                                    <div class="alert-title">Current Role: Administrator</div>
                                    <div>You have full access to all system features and data</div>
                                </div>
                            </div>
                        </div>

                        <div style="margin-bottom: 1.5rem;">
                            <h4 style="font-weight: 700; margin-bottom: 1rem; font-size: 1rem;">User Roles & Permissions</h4>
                            <ul class="list">
                                <li class="list-item">
                                    <div class="list-info">
                                        <div class="list-icon" style="background: rgba(239, 68, 68, 0.15); color: var(--red);">üëë</div>
                                        <div>
                                            <div class="list-title">Administrator</div>
                                            <div class="list-meta">Full system access ‚Ä¢ All permissions</div>
                                        </div>
                                    </div>
                                    <span style="background: rgba(239, 68, 68, 0.1); color: var(--red); padding: 0.35rem 0.75rem; border-radius: 6px; font-size: 0.85rem; font-weight: 600;">8 Users</span>
                                </li>
                                <li class="list-item">
                                    <div class="list-info">
                                        <div class="list-icon" style="background: rgba(245, 158, 11, 0.15); color: var(--orange);">‚≠ê</div>
                                        <div>
                                            <div class="list-title">Department Manager</div>
                                            <div class="list-meta">Department-level access ‚Ä¢ Edit & approve</div>
                                        </div>
                                    </div>
                                    <span style="background: rgba(245, 158, 11, 0.1); color: var(--orange); padding: 0.35rem 0.75rem; border-radius: 6px; font-size: 0.85rem; font-weight: 600;">24 Users</span>
                                </li>
                                <li class="list-item">
                                    <div class="list-info">
                                        <div class="list-icon" style="background: rgba(59, 130, 246, 0.15); color: var(--blue);">üë§</div>
                                        <div>
                                            <div class="list-title">Analyst</div>
                                            <div class="list-meta">Read & report access ‚Ä¢ Limited editing</div>
                                        </div>
                                    </div>
                                    <span style="background: rgba(59, 130, 246, 0.1); color: var(--blue); padding: 0.35rem 0.75rem; border-radius: 6px; font-size: 0.85rem; font-weight: 600;">67 Users</span>
                                </li>
                                <li class="list-item">
                                    <div class="list-info">
                                        <div class="list-icon" style="background: rgba(16, 185, 129, 0.15); color: var(--green);">üëÅÔ∏è</div>
                                        <div>
                                            <div class="list-title">Viewer</div>
                                            <div class="list-meta">Read-only access ‚Ä¢ No editing</div>
                                        </div>
                                    </div>
                                    <span style="background: rgba(16, 185, 129, 0.1); color: var(--green); padding: 0.35rem 0.75rem; border-radius: 6px; font-size: 0.85rem; font-weight: 600;">142 Users</span>
                                </li>
                            </ul>
                        </div>

                        <div style="background: var(--bg-tertiary); padding: 1.25rem; border-radius: 8px; margin-bottom: 1rem;">
                            <h4 style="font-weight: 700; margin-bottom: 1rem; font-size: 0.95rem;">Permission Matrix</h4>
                            <div style="overflow-x: auto;">
                                <table style="width: 100%; font-size: 0.85rem;">
                                    <thead>
                                        <tr>
                                            <th style="padding: 0.5rem; text-align: left;">Permission</th>
                                            <th style="padding: 0.5rem; text-align: center;">Admin</th>
                                            <th style="padding: 0.5rem; text-align: center;">Manager</th>
                                            <th style="padding: 0.5rem; text-align: center;">Analyst</th>
                                            <th style="padding: 0.5rem; text-align: center;">Viewer</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td style="padding: 0.5rem;">View Dashboard</td>
                                            <td style="padding: 0.5rem; text-align: center;"><span style="color: var(--green);">‚úì</span></td>
                                            <td style="padding: 0.5rem; text-align: center;"><span style="color: var(--green);">‚úì</span></td>
                                            <td style="padding: 0.5rem; text-align: center;"><span style="color: var(--green);">‚úì</span></td>
                                            <td style="padding: 0.5rem; text-align: center;"><span style="color: var(--green);">‚úì</span></td>
                                        </tr>
                                        <tr>
                                            <td style="padding: 0.5rem;">Edit Data</td>
                                            <td style="padding: 0.5rem; text-align: center;"><span style="color: var(--green);">‚úì</span></td>
                                            <td style="padding: 0.5rem; text-align: center;"><span style="color: var(--green);">‚úì</span></td>
                                            <td style="padding: 0.5rem; text-align: center;"><span style="color: var(--orange);">‚ñ≥</span></td>
                                            <td style="padding: 0.5rem; text-align: center;"><span style="color: var(--red);">‚úó</span></td>
                                        </tr>
                                        <tr>
                                            <td style="padding: 0.5rem;">Manage Users</td>
                                            <td style="padding: 0.5rem; text-align: center;"><span style="color: var(--green);">‚úì</span></td>
                                            <td style="padding: 0.5rem; text-align: center;"><span style="color: var(--orange);">‚ñ≥</span></td>
                                            <td style="padding: 0.5rem; text-align: center;"><span style="color: var(--red);">‚úó</span></td>
                                            <td style="padding: 0.5rem; text-align: center;"><span style="color: var(--red);">‚úó</span></td>
                                        </tr>
                                        <tr>
                                            <td style="padding: 0.5rem;">System Settings</td>
                                            <td style="padding: 0.5rem; text-align: center;"><span style="color: var(--green);">‚úì</span></td>
                                            <td style="padding: 0.5rem; text-align: center;"><span style="color: var(--red);">‚úó</span></td>
                                            <td style="padding: 0.5rem; text-align: center;"><span style="color: var(--red);">‚úó</span></td>
                                            <td style="padding: 0.5rem; text-align: center;"><span style="color: var(--red);">‚úó</span></td>
                                        </tr>
                                        <tr>
                                            <td style="padding: 0.5rem;">Export Reports</td>
                                            <td style="padding: 0.5rem; text-align: center;"><span style="color: var(--green);">‚úì</span></td>
                                            <td style="padding: 0.5rem; text-align: center;"><span style="color: var(--green);">‚úì</span></td>
                                            <td style="padding: 0.5rem; text-align: center;"><span style="color: var(--green);">‚úì</span></td>
                                            <td style="padding: 0.5rem; text-align: center;"><span style="color: var(--orange);">‚ñ≥</span></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            <div style="margin-top: 1rem; font-size: 0.8rem; color: var(--text-dim);">
                                <span style="color: var(--green);">‚úì</span> Full Access &nbsp;&nbsp;
                                <span style="color: var(--orange);">‚ñ≥</span> Limited Access &nbsp;&nbsp;
                                <span style="color: var(--red);">‚úó</span> No Access
                            </div>
                        </div>

                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.75rem;">
                            <button class="btn btn-primary">üë• Manage Roles</button>
                            <button class="btn" style="background: var(--bg-tertiary); color: var(--text);">üìä Access Audit</button>
                        </div>
                    </div>
                </div>

                <!-- Security Statistics -->
                <div class="stats">
                    <div class="stat-card" style="--accent: var(--green)">
                        <div class="stat-label">Active Sessions</div>
                        <div class="stat-value">241</div>
                        <span class="stat-change positive">‚Üë 12% Today</span>
                    </div>
                    <div class="stat-card" style="--accent: var(--blue)">
                        <div class="stat-label">Authentication Success Rate</div>
                        <div class="stat-value">98.7%</div>
                        <div class="progress"><div class="progress-bar" style="width: 98.7%"></div></div>
                    </div>
                    <div class="stat-card" style="--accent: var(--orange)">
                        <div class="stat-label">Failed Login Attempts</div>
                        <div class="stat-value">18</div>
                        <span class="stat-change negative">‚Üë 3 Today</span>
                    </div>
                    <div class="stat-card" style="--accent: var(--purple)">
                        <div class="stat-label">Users with 2FA Enabled</div>
                        <div class="stat-value">89%</div>
                        <div class="progress"><div class="progress-bar" style="width: 89%; background: linear-gradient(90deg, var(--purple), var(--blue));"></div></div>
                    </div>
                </div>

                <!-- Additional Security Features -->
                <div class="grid">
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">üîí Security Alerts</h3>
                        </div>
                        <ul class="list">
                            <li class="list-item">
                                <div class="list-info">
                                    <div class="list-icon" style="background: rgba(245, 158, 11, 0.15); color: var(--orange);">‚ö†Ô∏è</div>
                                    <div>
                                        <div class="list-title">Multiple Failed Login Attempts</div>
                                        <div class="list-meta">IP: 192.168.1.105 ‚Ä¢ 15 minutes ago</div>
                                    </div>
                                </div>
                                <span class="status status-warning">
                                    <span class="status-dot"></span>Review
                                </span>
                            </li>
                            <li class="list-item">
                                <div class="list-info">
                                    <div class="list-icon" style="background: rgba(16, 185, 129, 0.15); color: var(--green);">‚úì</div>
                                    <div>
                                        <div class="list-title">Password Changed Successfully</div>
                                        <div class="list-meta">User: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="d5bffbb4bbb1b0a7a6babb95a5a0b9a6b0b6bca1acfbb2baa3">[email&#160;protected]</a> ‚Ä¢ 2 hours ago</div>
                                    </div>
                                </div>
                                <span class="status status-good">
                                    <span class="status-dot"></span>Verified
                                </span>
                            </li>
                            <li class="list-item">
                                <div class="list-info">
                                    <div class="list-icon" style="background: rgba(59, 130, 246, 0.15); color: var(--blue);">üîê</div>
                                    <div>
                                        <div class="list-title">New 2FA Device Registered</div>
                                        <div class="list-meta">User: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="b5d89bd6ddd0dbf5c5c0d9c6d0d6dcc1cc9bd2dac3">[email&#160;protected]</a> ‚Ä¢ 4 hours ago</div>
                                    </div>
                                </div>
                                <span class="status status-good">
                                    <span class="status-dot"></span>Active
                                </span>
                            </li>
                        </ul>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">üìä Access Patterns</h3>
                        </div>
                        <div style="padding: 1rem 0;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 1rem; padding-bottom: 0.75rem; border-bottom: 1px solid var(--border);">
                                <span style="color: var(--text-dim);">Peak Login Hours</span>
                                <span style="font-weight: 700;">9:00 AM - 11:00 AM</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; margin-bottom: 1rem; padding-bottom: 0.75rem; border-bottom: 1px solid var(--border);">
                                <span style="color: var(--text-dim);">Most Active Department</span>
                                <span style="font-weight: 700;">Public Safety</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; margin-bottom: 1rem; padding-bottom: 0.75rem; border-bottom: 1px solid var(--border);">
                                <span style="color: var(--text-dim);">Average Session Duration</span>
                                <span style="font-weight: 700;">42 minutes</span>
                            </div>
                            <div style="display: flex; justify-content: space-between;">
                                <span style="color: var(--text-dim);">Geographic Distribution</span>
                                <span style="font-weight: 700;">87% Local</span>
                            </div>
                        </div>
                        <button class="btn btn-primary" style="width: 100%; margin-top: 1rem;">üìà View Detailed Analytics</button>
                    </div>
                </div>

                <div class="alert alert-success">
                    <span class="alert-icon">üîí</span>
                    <div>
                        <div class="alert-title">System Security Status: Optimal</div>
                        <div>All authentication and authorization systems are functioning normally. Last security audit: 3 days ago. Next scheduled audit: In 4 days.</div>
                    </div>
                </div>
            </section>
            <!-- MOBILE APP REPORTS (from File 2) -->
            <section id="mobile-reports" class="section">
                <div class="header">
                    <h1 class="title">üì± Mobile App Reports</h1>
                    <p class="subtitle">Citizen-reported incidents with location data</p>
                </div>

                <div class="stats">
                    <div class="stat-card" style="--accent: var(--blue)">
                        <div class="stat-label">Total Reports Today</div>
                        <div class="stat-value">23</div>
                        <span class="stat-change positive">‚Üë 15% vs yesterday</span>
                    </div>
                    <div class="stat-card" style="--accent: var(--orange)">
                        <div class="stat-label">Pending Review</div>
                        <div class="stat-value">7</div>
                        <span class="stat-change positive">‚Üì 3 resolved</span>
                    </div>
                    <div class="stat-card" style="--accent: var(--green)">
                        <div class="stat-label">Resolved Reports</div>
                        <div class="stat-value">16</div>
                        <span class="stat-change positive">‚Üë 70% resolution rate</span>
                    </div>
                    <div class="stat-card" style="--accent: var(--purple)">
                        <div class="stat-label">Average Response Time</div>
                        <div class="stat-value">2.3 hrs</div>
                        <span class="stat-change positive">‚Üì 25% faster</span>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">üìç Incident Location Map</h3>
                    </div>
                    <div id="incidentMap" class="map-container"></div>
                </div>

                <div class="grid">
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">‚ûï Submit New Report</h3>
                        </div>
                        <form id="incidentReportForm" class="report-form">
                            <div class="form-group">
                                <label class="form-label">Incident Type</label>
                                <select id="incidentType" class="form-select" required>
                                    <option value="">Select incident type</option>
                                    <option value="pothole">üï≥Ô∏è Pothole</option>
                                    <option value="streetlight">üí° Streetlight Out</option>
                                    <option value="graffiti">üé® Graffiti</option>
                                    <option value="trash">üóëÔ∏è Illegal Dumping</option>
                                    <option value="damage">‚ö†Ô∏è Property Damage</option>
                                    <option value="flooding">üåä Flooding</option>
                                    <option value="other">üìù Other</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Description</label>
                                <textarea id="incidentDescription" class="form-textarea" placeholder="Describe the incident..." required></textarea>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Location</label>
                                <button type="button" id="getLocationBtn" class="btn btn-primary" style="width: 100%;">
                                    üìç Get Current Location
                                </button>
                                <div id="locationDisplay" class="location-display" style="display: none; margin-top: 0.75rem;">
                                    <span class="location-icon">üìç</span>
                                    <span id="locationText">Location captured</span>
                                </div>
                                <input type="hidden" id="latitude" required>
                                <input type="hidden" id="longitude" required>
                            </div>
                            <button type="submit" class="btn btn-success" style="width: 100%;">
                                üì§ Submit Report
                            </button>
                        </form>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">üìã Recent Reports</h3>
                        </div>
                        <div id="reportsList">
                            <!-- Reports will be dynamically added here -->
                        </div>
                    </div>
                </div>
            </section>

        </main>
    </div>

    </div>

    <div class="toast" id="toast">
        <div class="toast-content">
            <span class="toast-icon" id="toastIcon">‚úì</span>
            <div>
                <div class="toast-title" id="toastTitle">Success</div>
                <div class="toast-text" id="toastText">Operation completed</div>
            </div>
        </div>
    </div>

    <script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script>
        // === DATA ===
        const DATA = {
            emergencies: [
                {id: 1, type: 'fire', location: 'Mill Street', time: '18 min ago'},
                {id: 2, type: 'accident', location: 'Oak Ave', time: '5 min ago'},
                {id: 3, type: 'flood', location: 'River District', time: '2 hrs ago'}
            ],
            citizenIssues: [
                {title: 'Pothole on 5th Ave', votes: 234, status: 'pending'},
                {title: 'Broken Street Light', votes: 189, status: 'in-progress'},
                {title: 'Park Maintenance', votes: 156, status: 'resolved'}
            ],
            traffic: [
                {road: 'Main Street', status: 'moderate', flow: 65},
                {road: 'Highway 101', status: 'light', flow: 90},
                {road: 'Downtown', status: 'heavy', flow: 35}
            ],
            transit: [
                {line: 'Bus Line 42', eta: '3 min', status: 'on-time'},
                {line: 'Metro Blue', eta: 'On schedule', status: 'on-time'},
                {line: 'Tram Route 5', eta: '5 min delay', status: 'delayed'}
            ],
            air: [
                {area: 'Downtown', aqi: 85, status: 'moderate'},
                {area: 'Riverside', aqi: 42, status: 'good'},
                {area: 'Industrial', aqi: 156, status: 'unhealthy'},
                {area: 'Suburbs', aqi: 58, status: 'good'}
            ],
            parking: [
                {name: 'City Center Garage', spots: 87, price: '$2/hr'},
                {name: 'Main Street Lot', spots: 34, price: '$1.5/hr'},
                {name: 'Library Parking', spots: 12, price: 'Free'}
            ],
            events: [
                {name: 'Music Festival', date: 'Today 7PM', crowd: 'High'},
                {name: 'City Marathon', date: 'Tomorrow 8AM', crowd: 'High'},
                {name: 'Art Exhibition', date: 'Feb 2', crowd: 'Low'}
            ],
            utilities: [
                {type: 'Internet', location: 'North District', users: 247}
            ],
            noise: [
                {area: 'Residential', level: 45, status: 'good'},
                {area: 'Commercial', level: 68, status: 'moderate'},
                {area: 'Highway', level: 82, status: 'poor'}
            ],
            waste: [
                {type: 'Regular Waste', days: 'Mon & Thu'},
                {type: 'Recycling', days: 'Wednesday'},
                {type: 'Yard Waste', days: 'Friday'}
            ],
            crime: [
                {area: 'Downtown', rating: 'medium', incidents: 12},
                {area: 'Residential North', rating: 'high', incidents: 3},
                {area: 'Industrial South', rating: 'low', incidents: 18}
            ],
            sensors: [
                {type: 'Streetlights', total: 2850, active: 2847},
                {type: 'Traffic Cameras', total: 92, active: 89},
                {type: 'Temp Sensors', total: 160, active: 156}
            ],
            polls: [
                {question: 'Add more bike lanes downtown?', options: ['Yes', 'No'], votes: [834, 413]},
                {question: 'New park location?', options: ['North', 'South', 'East'], votes: [401, 285, 206]}
            ],
            budget: [
                {dept: 'Education', allocated: 38.2, spent: 24.1, percent: 30},
                {dept: 'Public Safety', allocated: 31.8, spent: 19.6, percent: 25},
                {dept: 'Infrastructure', allocated: 25.5, spent: 18.2, percent: 20},
                {dept: 'Healthcare', allocated: 19.1, spent: 11.5, percent: 15},
                {dept: 'Parks', allocated: 12.9, spent: 8.4, percent: 10}
            ],
            healthMetrics: [
                {metric: 'Traffic Flow', score: 78, status: 'good', trend: '‚Üë'},
                {metric: 'Air Quality', score: 82, status: 'good', trend: '‚Üë'},
                {metric: 'Emergency Response', score: 91, status: 'excellent', trend: '‚Üí'},
                {metric: 'Utility Services', score: 88, status: 'good', trend: '‚Üë'}
            ],
            forecast: [
                {day: 'Today', cond: 'Sunny', high: 75, low: 62, precip: '10%'},
                {day: 'Tomorrow', cond: 'Thunderstorms', high: 71, low: 59, precip: '80%'},
                {day: 'Wed', cond: 'Partly Cloudy', high: 73, low: 61, precip: '20%'},
                {day: 'Thu', cond: 'Sunny', high: 78, low: 64, precip: '5%'}
            ]
        };

        // === NAVIGATION ===
        document.querySelectorAll('.nav-item').forEach(item => {
            item.addEventListener('click', () => {
                document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
                item.classList.add('active');
                document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
                document.getElementById(item.dataset.section).classList.add('active');
            });
        });

        // === TOAST ===
        function showToast(title, text, icon = '‚úì') {
            const toast = document.getElementById('toast');
            document.getElementById('toastIcon').textContent = icon;
            document.getElementById('toastTitle').textContent = title;
            document.getElementById('toastText').textContent = text;
            toast.classList.add('show');
            setTimeout(() => toast.classList.remove('show'), 4000);
        }

        // === RENDER DATA ===
        function renderList(id, data, template) {
            const el = document.getElementById(id);
            if (!el) return;
            el.innerHTML = data.map(template).join('');
        }

        const icons = {fire: 'üî•', accident: 'üöó', flood: 'üíß'};
        renderList('dashEmergencies', DATA.emergencies, e => `
            <li class="list-item">
                <div class="list-info">
                    <div class="list-icon">${icons[e.type] || 'üö®'}</div>
                    <div>
                        <div class="list-title">${e.type} - ${e.location}</div>
                        <div class="list-meta">${e.time}</div>
                    </div>
                </div>
                <span class="status status-danger"><span class="status-dot"></span>Active</span>
            </li>
        `);
        renderList('emergencyList', DATA.emergencies, e => `
            <li class="list-item">
                <div class="list-info">
                    <div class="list-icon">${icons[e.type] || 'üö®'}</div>
                    <div>
                        <div class="list-title">${e.type} - ${e.location}</div>
                        <div class="list-meta">${e.time}</div>
                    </div>
                </div>
                <span class="status status-danger"><span class="status-dot"></span>Active</span>
            </li>
        `);

        renderList('dashIssues', DATA.citizenIssues, i => `
            <li class="list-item">
                <div class="list-info">
                    <div class="list-icon">üó£Ô∏è</div>
                    <div>
                        <div class="list-title">${i.title}</div>
                        <div class="list-meta">${i.votes} votes</div>
                    </div>
                </div>
                <span class="status ${i.status === 'resolved' ? 'status-good' : i.status === 'in-progress' ? 'status-warning' : 'status-danger'}">
                    <span class="status-dot"></span>${i.status}
                </span>
            </li>
        `);
        
        // Function to render citizen issues including localStorage reports
        function renderCitizenIssues() {
            const storedReports = JSON.parse(localStorage.getItem('pulsecity_incidents') || '[]');
            
            // Convert stored reports to citizen issue format
            const citizenReports = storedReports.map(report => {
                const typeLabels = {
                    'pothole': 'Pothole',
                    'streetlight': 'Broken Street Light',
                    'graffiti': 'Graffiti Issue',
                    'trash': 'Illegal Dumping',
                    'damage': 'Property Damage',
                    'flooding': 'Flooding',
                    'other': 'Other Issue'
                };
                
                return {
                    title: typeLabels[report.type] || report.type,
                    description: report.description,
                    location: `${report.latitude.toFixed(4)}, ${report.longitude.toFixed(4)}`,
                    timestamp: report.timestamp,
                    status: report.status || 'pending',
                    votes: 0,
                    reportedBy: report.reportedBy || 'Citizen'
                };
            });
            
            // Combine static data with stored reports
            const allIssues = [...citizenReports, ...DATA.citizenIssues];
            
            // Update stats
            const totalCount = storedReports.length + DATA.citizenIssues.length;
            const pendingCount = allIssues.filter(i => i.status === 'pending').length;
            const inProgressCount = allIssues.filter(i => i.status === 'in-progress').length;
            const resolvedCount = allIssues.filter(i => i.status === 'resolved').length;
            
            const totalEl = document.getElementById('totalReportsCount');
            const pendingEl = document.getElementById('pendingReportsCount');
            const inProgressEl = document.getElementById('inProgressReportsCount');
            const resolvedEl = document.getElementById('resolvedReportsCount');
            
            if (totalEl) totalEl.textContent = totalCount.toLocaleString();
            if (pendingEl) pendingEl.textContent = pendingCount.toLocaleString();
            if (inProgressEl) inProgressEl.textContent = inProgressCount.toLocaleString();
            if (resolvedEl) resolvedEl.textContent = resolvedCount.toLocaleString();
            
            renderList('citizenList', allIssues, i => `
                <li class="list-item">
                    <div class="list-info">
                        <div class="list-icon">üó£Ô∏è</div>
                        <div>
                            <div class="list-title">${i.title}</div>
                            <div class="list-meta">${i.description || i.votes + ' votes'}${i.location ? ' ‚Ä¢ ' + i.location : ''}</div>
                        </div>
                    </div>
                    <span class="status ${i.status === 'resolved' ? 'status-good' : i.status === 'in-progress' ? 'status-warning' : 'status-danger'}">
                        <span class="status-dot"></span>${i.status}
                    </span>
                </li>
            `);
        }
        
        // Initial render
        renderCitizenIssues();

        renderList('trafficList', DATA.traffic, t => `
            <li class="list-item">
                <div class="list-info">
                    <div class="list-icon">üö¶</div>
                    <div>
                        <div class="list-title">${t.road}</div>
                        <div class="list-meta">Flow: ${t.flow}%</div>
                    </div>
                </div>
                <span class="status ${t.status === 'light' ? 'status-good' : t.status === 'moderate' ? 'status-warning' : 'status-danger'}">
                    <span class="status-dot"></span>${t.status}
                </span>
            </li>
        `);

        renderList('transitList', DATA.transit, t => `
            <li class="list-item">
                <div class="list-info">
                    <div class="list-icon">üöá</div>
                    <div>
                        <div class="list-title">${t.line}</div>
                        <div class="list-meta">${t.eta}</div>
                    </div>
                </div>
                <span class="status ${t.status === 'on-time' ? 'status-good' : 'status-warning'}">
                    <span class="status-dot"></span>${t.status}
                </span>
            </li>
        `);

        renderList('airList', DATA.air, a => `
            <li class="list-item">
                <div class="list-info">
                    <div class="list-icon">üè≠</div>
                    <div>
                        <div class="list-title">${a.area}</div>
                        <div class="list-meta">AQI: ${a.aqi}</div>
                    </div>
                </div>
                <span class="status ${a.status === 'good' ? 'status-good' : a.status === 'moderate' ? 'status-warning' : 'status-danger'}">
                    <span class="status-dot"></span>${a.status}
                </span>
            </li>
        `);

        renderList('parkingList', DATA.parking, p => `
            <li class="list-item">
                <div class="list-info">
                    <div class="list-icon">üÖøÔ∏è</div>
                    <div>
                        <div class="list-title">${p.name}</div>
                        <div class="list-meta">${p.spots} spots ‚Ä¢ ${p.price}</div>
                    </div>
                </div>
            </li>
        `);

        renderList('eventsList', DATA.events, e => `
            <li class="list-item">
                <div class="list-info">
                    <div class="list-icon">üìÖ</div>
                    <div>
                        <div class="list-title">${e.name}</div>
                        <div class="list-meta">${e.date} ‚Ä¢ ${e.crowd} Crowd</div>
                    </div>
                </div>
            </li>
        `);

        renderList('utilityList', DATA.utilities, u => `
            <li class="list-item">
                <div class="list-info">
                    <div class="list-icon">üîå</div>
                    <div>
                        <div class="list-title">${u.type} - ${u.location}</div>
                        <div class="list-meta">${u.users} users affected</div>
                    </div>
                </div>
                <span class="status status-warning"><span class="status-dot"></span>Outage</span>
            </li>
        `);

        renderList('noiseList', DATA.noise, n => `
            <li class="list-item">
                <div class="list-info">
                    <div class="list-icon">üîä</div>
                    <div>
                        <div class="list-title">${n.area}</div>
                        <div class="list-meta">${n.level} dB</div>
                    </div>
                </div>
                <span class="status ${n.status === 'good' ? 'status-good' : n.status === 'moderate' ? 'status-warning' : 'status-danger'}">
                    <span class="status-dot"></span>${n.status}
                </span>
            </li>
        `);

        renderList('wasteList', DATA.waste, w => `
            <li class="list-item">
                <div class="list-info">
                    <div class="list-icon">${w.type.includes('Regular') ? 'üóëÔ∏è' : w.type.includes('Recycling') ? '‚ôªÔ∏è' : 'üçÉ'}</div>
                    <div>
                        <div class="list-title">${w.type}</div>
                        <div class="list-meta">${w.days}</div>
                    </div>
                </div>
            </li>
        `);

        renderList('crimeList', DATA.crime, c => `
            <li class="list-item">
                <div class="list-info">
                    <div class="list-icon">üõ°Ô∏è</div>
                    <div>
                        <div class="list-title">${c.area}</div>
                        <div class="list-meta">${c.incidents} incidents</div>
                    </div>
                </div>
                <span class="status ${c.rating === 'high' ? 'status-good' : c.rating === 'medium' ? 'status-warning' : 'status-danger'}">
                    <span class="status-dot"></span>${c.rating} safety
                </span>
            </li>
        `);

        renderList('sensorsList', DATA.sensors, s => `
            <li class="list-item">
                <div class="list-info">
                    <div class="list-icon">üì°</div>
                    <div>
                        <div class="list-title">${s.type}</div>
                        <div class="list-meta">${s.active} / ${s.total} active</div>
                    </div>
                </div>
                <span class="status status-good"><span class="status-dot"></span>Online</span>
            </li>
        `);

        // Tables
        if (document.getElementById('healthTable')) {
            document.getElementById('healthTable').innerHTML = DATA.healthMetrics.map(m => `
                <tr>
                    <td>${m.metric}</td>
                    <td>${m.score}</td>
                    <td><span class="status status-good"><span class="status-dot"></span>${m.status}</span></td>
                    <td>${m.trend}</td>
                </tr>
            `).join('');
        }

        if (document.getElementById('forecastTable')) {
            document.getElementById('forecastTable').innerHTML = DATA.forecast.map(f => `
                <tr>
                    <td>${f.day}</td>
                    <td>${f.cond}</td>
                    <td>${f.high}¬∞ / ${f.low}¬∞</td>
                    <td>${f.precip}</td>
                </tr>
            `).join('');
        }

        if (document.getElementById('budgetTable')) {
            document.getElementById('budgetTable').innerHTML = DATA.budget.map(b => `
                <tr>
                    <td>${b.dept}</td>
                    <td>$${b.allocated}M</td>
                    <td>$${b.spent}M</td>
                    <td>$${(b.allocated - b.spent).toFixed(1)}M</td>
                    <td>${b.percent}%</td>
                </tr>
            `).join('');
        }

        // Polls
        if (document.getElementById('pollsList')) {
            document.getElementById('pollsList').innerHTML = DATA.polls.map((p, i) => `
                <div class="poll">
                    <div class="poll-question">${p.question}</div>
                    ${p.options.map((opt, j) => `
                        <label class="poll-option">
                            <input type="radio" name="poll${i}" value="${j}">
                            <span>${opt} (${Math.round(p.votes[j] / p.votes.reduce((a,b)=>a+b) * 100)}%)</span>
                        </label>
                    `).join('')}
                    <div class="poll-meta">${p.votes.reduce((a,b)=>a+b)} votes</div>
                </div>
            `).join('');
        }

        // === FORMS ===
        const forms = [
            'trafficForm', 'transitForm', 'airForm', 'emergencyForm', 'citizenForm',
            'utilityForm', 'parkingForm', 'eventsForm', 'noiseForm', 'wasteForm'
        ];

        forms.forEach(formId => {
            const form = document.getElementById(formId);
            if (form) {
                form.addEventListener('submit', (e) => {
                    e.preventDefault();
                    showToast('Success', 'Your submission has been received!');
                    form.reset();
                });
            }
        });

        if (document.getElementById('votePollBtn')) {
            document.getElementById('votePollBtn').addEventListener('click', () => {
                showToast('Vote Recorded', 'Thank you for participating!');
            });
        }

        // === SEARCH ===
        document.getElementById('globalSearch').addEventListener('input', (e) => {
            console.log('Searching:', e.target.value);
        });

        // === UPDATE HEALTH SCORE ===
        setInterval(() => {
            const score = Math.floor(Math.random() * 5) + 83;
            document.getElementById('healthScore').textContent = score;
        }, 10000);

        // === MONITORING SECTION CHARTS ===
        // Traffic Prediction Chart
        if (document.getElementById('trafficPredictionChart')) {
            const trafficCtx = document.getElementById('trafficPredictionChart').getContext('2d');
            const now = new Date();
            const labels = [];
            for (let i = 0; i < 12; i++) {
                const time = new Date(now.getTime() + i * 15 * 60000);
                labels.push(time.toLocaleTimeString('en-US', { hour: 'numeric', minute: '2-digit' }));
            }
            
            new Chart(trafficCtx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [
                        {
                            label: 'Actual Flow',
                            data: [72, 70, 65, 58, 45, null, null, null, null, null, null, null],
                            borderColor: '#3b82f6',
                            backgroundColor: 'rgba(59, 130, 246, 0.1)',
                            borderWidth: 3,
                            tension: 0.4,
                            fill: true,
                            pointRadius: 5,
                            pointHoverRadius: 7
                        },
                        {
                            label: 'ML Prediction',
                            data: [null, null, null, null, 45, 42, 55, 68, 78, 85, 88, 92],
                            borderColor: '#8b5cf6',
                            backgroundColor: 'rgba(139, 92, 246, 0.1)',
                            borderWidth: 3,
                            borderDash: [5, 5],
                            tension: 0.4,
                            fill: true,
                            pointRadius: 5,
                            pointHoverRadius: 7
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            labels: { color: '#f1f5f9', font: { size: 12, weight: '600' } }
                        },
                        tooltip: {
                            backgroundColor: '#1e293b',
                            titleColor: '#f1f5f9',
                            bodyColor: '#94a3b8',
                            borderColor: '#334155',
                            borderWidth: 1,
                            padding: 12,
                            displayColors: true,
                            callbacks: {
                                label: function(context) {
                                    return context.dataset.label + ': ' + context.parsed.y + '% flow';
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100,
                            ticks: { 
                                color: '#94a3b8',
                                callback: function(value) { return value + '%'; }
                            },
                            grid: { color: '#334155' }
                        },
                        x: {
                            ticks: { color: '#94a3b8' },
                            grid: { color: '#334155' }
                        }
                    }
                }
            });
        }

        // Environmental Chart
        if (document.getElementById('environmentalChart')) {
            const envCtx = document.getElementById('environmentalChart').getContext('2d');
            const now = new Date();
            const envLabels = [];
            for (let i = 0; i < 24; i += 3) {
                const time = new Date(now.getTime() + i * 60 * 60000);
                envLabels.push(time.toLocaleTimeString('en-US', { hour: 'numeric' }));
            }
            
            new Chart(envCtx, {
                type: 'line',
                data: {
                    labels: envLabels,
                    datasets: [
                        {
                            label: 'AQI',
                            data: [68, 72, 75, 82, 78, 72, 68, 58],
                            borderColor: '#10b981',
                            backgroundColor: 'rgba(16, 185, 129, 0.1)',
                            borderWidth: 3,
                            tension: 0.4,
                            yAxisID: 'y',
                            fill: true,
                            pointRadius: 4,
                            pointHoverRadius: 6
                        },
                        {
                            label: 'Temperature (¬∞F)',
                            data: [72, 70, 68, 68, 65, 62, 60, 58],
                            borderColor: '#06b6d4',
                            backgroundColor: 'rgba(6, 182, 212, 0.1)',
                            borderWidth: 3,
                            tension: 0.4,
                            yAxisID: 'y1',
                            fill: true,
                            pointRadius: 4,
                            pointHoverRadius: 6
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: {
                        mode: 'index',
                        intersect: false,
                    },
                    plugins: {
                        legend: {
                            labels: { color: '#f1f5f9', font: { size: 12, weight: '600' } }
                        },
                        tooltip: {
                            backgroundColor: '#1e293b',
                            titleColor: '#f1f5f9',
                            bodyColor: '#94a3b8',
                            borderColor: '#334155',
                            borderWidth: 1,
                            padding: 12
                        }
                    },
                    scales: {
                        y: {
                            type: 'linear',
                            display: true,
                            position: 'left',
                            title: { display: true, text: 'AQI', color: '#10b981' },
                            ticks: { color: '#94a3b8' },
                            grid: { color: '#334155' }
                        },
                        y1: {
                            type: 'linear',
                            display: true,
                            position: 'right',
                            title: { display: true, text: 'Temperature (¬∞F)', color: '#06b6d4' },
                            ticks: { color: '#94a3b8' },
                            grid: { drawOnChartArea: false }
                        },
                        x: {
                            ticks: { color: '#94a3b8' },
                            grid: { color: '#334155' }
                        }
                    }
                }
            });
        }

        // Update monitoring data in real-time
        setInterval(() => {
            const flow = Math.floor(Math.random() * 20) + 65;
            const predicted = Math.floor(Math.random() * 20) + 55;
            const aqi = Math.floor(Math.random() * 30) + 58;
            const temp = Math.floor(Math.random() * 10) + 68;
            
            const flowEl = document.getElementById('currentFlow');
            if (flowEl) flowEl.textContent = flow + '%';
            const predictedEl = document.getElementById('predictedFlow');
            if (predictedEl) predictedEl.textContent = predicted + '%';
            const aqiEl = document.getElementById('currentAQI');
            if (aqiEl) aqiEl.textContent = aqi;
            const tempEl = document.getElementById('currentTemp');
            if (tempEl) tempEl.textContent = temp + '¬∞F';
        }, 5000);

        // === MOBILE REPORTS (from File 2) ===
        let incidentMap;
        let incidentReports = JSON.parse(localStorage.getItem('pulsecity_incidents') || '[]');
        let userMarker;

        // Initialize Incident Map
        function initIncidentMap() {
            incidentMap = L.map('incidentMap').setView([40.7128, -74.0060], 12);
            
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '¬© OpenStreetMap contributors'
            }).addTo(incidentMap);

            // Add some sample incident markers
            const sampleIncidents = [
                { lat: 40.7580, lng: -73.9855, type: 'pothole', desc: 'Large pothole on 5th Ave' },
                { lat: 40.7489, lng: -73.9680, type: 'streetlight', desc: 'Streetlight out near Madison Square' },
                { lat: 40.7614, lng: -73.9776, type: 'graffiti', desc: 'Graffiti on building wall' }
            ];

            sampleIncidents.forEach(incident => {
                const icon = getIncidentIcon(incident.type);
                L.marker([incident.lat, incident.lng], {
                    icon: L.divIcon({
                        className: 'incident-marker',
                        html: icon,
                        iconSize: [30, 30]
                    })
                }).addTo(incidentMap).bindPopup(`<b>${incident.type}</b><br>${incident.desc}`);
            });
        }

        // Get Incident Icon
        function getIncidentIcon(type) {
            const icons = {
                'pothole': 'üï≥Ô∏è',
                'streetlight': 'üí°',
                'graffiti': 'üé®',
                'trash': 'üóëÔ∏è',
                'damage': '‚ö†Ô∏è',
                'flooding': 'üåä',
                'other': 'üìù'
            };
            return icons[type] || 'üìç';
        }

        // Get User Location
        document.getElementById('getLocationBtn').addEventListener('click', function() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(
                    (position) => {
                        const lat = position.coords.latitude;
                        const lng = position.coords.longitude;
                        
                        document.getElementById('latitude').value = lat;
                        document.getElementById('longitude').value = lng;
                        
                        const locationDisplay = document.getElementById('locationDisplay');
                        const locationText = document.getElementById('locationText');
                        
                        locationDisplay.style.display = 'flex';
                        locationText.textContent = `Location captured: ${lat.toFixed(6)}, ${lng.toFixed(6)}`;
                        
                        // Add marker to map
                        if (userMarker) {
                            incidentMap.removeLayer(userMarker);
                        }
                        userMarker = L.marker([lat, lng]).addTo(incidentMap);
                        incidentMap.setView([lat, lng], 15);
                        
                        showToast('Location Captured', 'Your current location has been recorded', 'üìç');
                    },
                    (error) => {
                        showToast('Location Error', 'Unable to get your location. Please try again.', '‚ùå');
                    }
                );
            } else {
                showToast('Not Supported', 'Geolocation is not supported by your browser', '‚ùå');
            }
        });

        // Submit Incident Report
        document.getElementById('incidentReportForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const type = document.getElementById('incidentType').value;
            const description = document.getElementById('incidentDescription').value;
            const lat = document.getElementById('latitude').value;
            const lng = document.getElementById('longitude').value;
            
            const report = {
                id: Date.now(),
                type: type,
                description: description,
                latitude: parseFloat(lat),
                longitude: parseFloat(lng),
                timestamp: new Date().toISOString(),
                status: 'pending',
                reportedBy: 'Citizen'
            };
            
            incidentReports.unshift(report);
            
            // Save to localStorage
            localStorage.setItem('pulsecity_incidents', JSON.stringify(incidentReports));
            
            // Update admin portal citizen reports
            if (typeof renderCitizenIssues === 'function') {
                renderCitizenIssues();
            }
            
            // Add marker to map
            const icon = getIncidentIcon(type);
            L.marker([report.latitude, report.longitude], {
                icon: L.divIcon({
                    className: 'incident-marker',
                    html: icon,
                    iconSize: [30, 30]
                })
            }).addTo(incidentMap).bindPopup(`<b>${type}</b><br>${description}`);
            
            // Update reports list
            updateReportsList();
            
            // Reset form
            this.reset();
            document.getElementById('locationDisplay').style.display = 'none';
            if (userMarker) {
                incidentMap.removeLayer(userMarker);
            }
            
            showToast('Report Submitted', 'Your incident report has been submitted successfully', '‚úÖ');
        });

        // Update Reports List
        function updateReportsList() {
            const reportsList = document.getElementById('reportsList');
            
            if (incidentReports.length === 0) {
                reportsList.innerHTML = '<p style="color: var(--text-dim); text-align: center; padding: 2rem;">No reports yet</p>';
                return;
            }
            
            reportsList.innerHTML = incidentReports.map(report => {
                const typeLabels = {
                    'pothole': 'üï≥Ô∏è Pothole',
                    'streetlight': 'üí° Streetlight',
                    'graffiti': 'üé® Graffiti',
                    'trash': 'üóëÔ∏è Illegal Dumping',
                    'damage': '‚ö†Ô∏è Damage',
                    'flooding': 'üåä Flooding',
                    'other': 'üìù Other'
                };
                
                const timeAgo = getTimeAgo(report.timestamp);
                
                return `
                    <div class="report-item">
                        <div class="report-header">
                            <span class="report-type">${typeLabels[report.type]}</span>
                            <span class="report-time">${timeAgo}</span>
                        </div>
                        <p style="margin: 0.5rem 0; color: var(--text);">${report.description}</p>
                        <div class="report-location">
                            <span>üìç</span>
                            <span>${report.latitude.toFixed(6)}, ${report.longitude.toFixed(6)}</span>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // Get Time Ago
        function getTimeAgo(date) {
            const timestamp = typeof date === 'string' ? new Date(date) : date;
            const seconds = Math.floor((new Date() - timestamp) / 1000);
            
            if (seconds < 60) return 'Just now';
            if (seconds < 3600) return Math.floor(seconds / 60) + ' minutes ago';
            if (seconds < 86400) return Math.floor(seconds / 3600) + ' hours ago';
            return Math.floor(seconds / 86400) + ' days ago';
        }

        // Initialize map when mobile-reports section is shown
        const mobileReportsNav = document.querySelector('[data-section="mobile-reports"]');
        if (mobileReportsNav) {
            mobileReportsNav.addEventListener('click', function() {
                setTimeout(() => {
                    if (!incidentMap) {
                        initIncidentMap();
                    } else {
                        incidentMap.invalidateSize();
                    }
                }, 100);
            });
        }

        // === LOGIN SYSTEM (from File 2) ===
        const loginContainer = document.getElementById('loginContainer');
        const dashboardWrapper = document.getElementById('dashboardWrapper');
        const loginForm = document.getElementById('loginForm');
        const loginError = document.getElementById('loginError');
        const userProfile = document.getElementById('userProfile');
        const logoutDropdown = document.getElementById('logoutDropdown');
        const logoutBtn = document.getElementById('logoutBtn');
        const userAvatar = document.getElementById('userAvatar');
        const userName = document.getElementById('userName');
        
        // Demo users database
        const users = {
            'admin': { password: 'admin123', name: 'Admin User', role: 'Administrator' },
            'user': { password: 'user123', name: 'John Doe', role: 'User' }
        };
        
        // Check if user is already logged in
        function checkLogin() {
            const loggedInUser = localStorage.getItem('pulsecity_user');
            if (loggedInUser) {
                const userData = JSON.parse(loggedInUser);
                showDashboard(userData);
            }
        }
        
        // Handle login
        loginForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const username = document.getElementById('loginUsername').value.trim();
            const password = document.getElementById('loginPassword').value;
            
            if (users[username] && users[username].password === password) {
                const userData = { username, name: users[username].name, role: users[username].role };
                localStorage.setItem('pulsecity_user', JSON.stringify(userData));
                showDashboard(userData);
                loginError.classList.remove('show');
            } else {
                loginError.classList.add('show');
                setTimeout(() => loginError.classList.remove('show'), 3000);
            }
        });
        
        // Show dashboard after successful login
        function showDashboard(userData) {
            loginContainer.classList.add('hidden');
            dashboardWrapper.classList.add('show');
            
            // Update user profile
            const initials = userData.name.split(' ').map(n => n[0]).join('').toUpperCase();
            userAvatar.textContent = initials;
            userName.textContent = userData.name;
        }
        
        // Toggle logout dropdown
        userProfile.addEventListener('click', (e) => {
            e.stopPropagation();
            logoutDropdown.classList.toggle('show');
        });
        
        // Close dropdown when clicking outside
        document.addEventListener('click', () => {
            logoutDropdown.classList.remove('show');
        });
        
        // Handle logout
        logoutBtn.addEventListener('click', () => {
            localStorage.removeItem('pulsecity_user');
            loginContainer.classList.remove('hidden');
            dashboardWrapper.classList.remove('show');
            loginForm.reset();
            logoutDropdown.classList.remove('show');
        });
        
        // Initialize on page load
        checkLogin();
    </script>
</body>
</html>